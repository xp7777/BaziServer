# 八字命理AI人生指导系统开发需求说明书

## 1. 项目概述

### 1.1 项目背景

随着人工智能技术的发展和传统文化的复兴，将传统八字命理与现代AI技术相结合，为用户提供个性化的人生指导建议，具有广阔的市场前景。本项目旨在开发一个基于传统文化八字命理理论的AI人生指导系统，通过用户输入的出生信息，结合八字命理理论和AI大模型，为用户提供针对性的人生指导建议。

### 1.2 项目目标

开发一个易于使用、功能完善的八字命理AI人生指导系统，实现以下目标：

1. 为用户提供便捷的信息输入界面，收集用户的性别、出生年月日时等基本信息
2. 基于开源的万年历和真太阳时数据，准确计算用户的八字和流年大运信息
3. 通过ChatGPT API，将用户的八字信息转化为个性化的人生指导建议
4. 提供多种支付方式（微信支付、支付宝），实现便捷的在线支付功能
5. 支持结果的在线展示和PDF下载，提升用户体验
6. 实现用户登录和历史查询记录功能，方便用户查看历史结果
7. 开发适合在公众号H5页面部署的轻量级应用

## 2. 功能需求

### 2.1 用户界面

#### 2.1.1 主页面

1. 系统名称和简介展示
2. 用户信息输入表单，包括：
   - 性别选择（男/女）
   - 出生年月日时选择（支持公历和农历切换）
   - 推算侧重点选择（身体健康、财运、事业、婚姻感情、子女等多选项）
3. 提交按钮
4. 用户登录/注册入口

#### 2.1.2 支付页面

1. 订单信息展示（服务内容、价格9.9元）
2. 支付方式选择（微信支付、支付宝）
3. 支付二维码/按钮
4. 支付状态提示

#### 2.1.3 结果展示页面

1. 用户基本信息概览
2. 八字命盘展示（天干地支、五行属性等）
3. 流年大运信息展示
4. AI分析结果展示（分为多个模块，对应用户选择的侧重点）
5. PDF下载按钮
6. 分享功能

#### 2.1.4 用户中心页面

1. 用户基本信息
2. 历史查询记录列表
3. 订单记录
4. 账号设置

### 2.2 后台功能

#### 2.2.1 八字命理计算模块

1. 集成开源万年历数据，支持公历与农历转换
2. 实现真太阳时计算功能
3. 根据用户出生信息，计算八字（年柱、月柱、日柱、时柱）
4. 计算用户的流年大运信息
5. 生成完整的八字命盘数据

#### 2.2.2 AI分析模块

1. 集成ChatGPT API
2. 构建专业的八字命理提示词模板
3. 根据用户选择的侧重点，生成相应的AI提问内容
4. 处理和优化AI返回的结果
5. 支持结果的格式化和分类展示

#### 2.2.3 用户管理模块

1. 用户注册与登录功能
2. 用户信息管理
3. 历史查询记录存储与管理
4. 用户权限控制

#### 2.2.4 支付与订单模块

1. 微信支付接口集成
2. 支付宝接口集成
3. 订单创建与管理
4. 支付状态跟踪与通知
5. 订单查询与统计

#### 2.2.5 PDF生成模块

1. 根据AI分析结果，生成格式美观的PDF文档
2. 支持自定义PDF模板
3. 包含用户信息、八字命盘和分析结果
4. 支持PDF下载功能

## 3. 用户流程

### 3.1 基本流程

1. 用户访问系统主页
2. 用户填写个人信息（性别、出生年月日时）和选择推算侧重点
3. 用户点击提交按钮，进入支付页面
4. 用户选择支付方式并完成支付（9.9元）
5. 系统后台计算用户的八字和流年大运信息
6. 系统将八字信息和用户需求通过API发送给ChatGPT
7. 接收并处理ChatGPT返回的分析结果
8. 在结果页面向用户展示分析内容
9. 用户可查看结果并下载PDF文档
10. 系统保存用户的查询记录

### 3.2 注册登录流程

1. 用户点击注册/登录按钮
2. 输入手机号码并获取验证码
3. 验证成功后完成注册/登录
4. 系统记录用户信息并创建账户
5. 用户可在个人中心查看历史记录

### 3.3 支付流程

1. 用户提交信息后，系统生成订单
2. 展示订单信息和支付金额（9.9元）
3. 用户选择支付方式（微信支付或支付宝）
4. 系统调用相应的支付接口
5. 用户完成支付
6. 系统接收支付结果通知并更新订单状态
7. 支付成功后，系统开始进行八字计算和AI分析

## 4. 技术架构

### 4.1 前端技术

1. 框架：Vue.js/React.js
2. UI组件库：Element UI/Ant Design
3. 响应式设计：适配移动端和PC端
4. PDF生成：jsPDF
5. 图表展示：ECharts（用于八字命盘可视化）

### 4.2 后端技术

1. 开发语言：Node.js/Python
2. Web框架：Express.js/Flask/Django
3. 数据库：MySQL/MongoDB
4. 缓存：Redis
5. API接口：RESTful API

### 4.3 第三方服务集成

1. AI服务：ChatGPT API
2. 支付服务：微信支付API、支付宝API
3. 短信服务：阿里云短信/腾讯云短信（用于验证码）
4. 对象存储：阿里云OSS/腾讯云COS（用于存储PDF文件）

### 4.4 部署架构

1. 前端部署：静态资源托管，适配公众号H5页面
2. 后端部署：云服务器/云函数
3. 数据库部署：云数据库服务
4. CDN加速：提升访问速度

## 5. 数据模型

### 5.1 用户数据模型

```
User {
    id: String,              // 用户唯一标识
    phone: String,           // 手机号码
    createTime: DateTime,    // 创建时间
    lastLoginTime: DateTime, // 最后登录时间
    status: Enum             // 用户状态
}
```

### 5.2 订单数据模型

```
Order {
    id: String,              // 订单唯一标识
    userId: String,          // 用户ID
    amount: Decimal,         // 订单金额
    status: Enum,            // 订单状态
    paymentMethod: Enum,     // 支付方式
    createTime: DateTime,    // 创建时间
    payTime: DateTime,       // 支付时间
    resultId: String         // 关联的结果ID
}
```

### 5.3 八字结果数据模型

```
BaziResult {
    id: String,              // 结果唯一标识
    userId: String,          // 用户ID
    orderId: String,         // 订单ID
    gender: Enum,            // 性别
    birthTime: {             // 出生时间
        year: Number,
        month: Number,
        day: Number,
        hour: Number,
        isLunar: Boolean     // 是否农历
    },
    focusAreas: Array,       // 关注领域
    baziData: {              // 八字数据
        yearPillar: Object,
        monthPillar: Object,
        dayPillar: Object,
        hourPillar: Object,
        fiveElements: Object,
        flowingYears: Array
    },
    aiAnalysis: {            // AI分析结果
        health: String,
        wealth: String,
        career: String,
        relationship: String,
        children: String,
        overall: String
    },
    pdfUrl: String,          // PDF文件URL
    createTime: DateTime     // 创建时间
}
```

## 6. 安全与隐私

### 6.1 数据安全

1. 用户数据加密存储
2. 传输过程采用HTTPS加密
3. 定期数据备份
4. 敏感信息脱敏处理

### 6.2 隐私保护

1. 明确的隐私政策
2. 用户授权机制
3. 最小化收集用户信息
4. 符合相关法律法规要求

### 6.3 支付安全

1. 支付过程全程加密
2. 接入官方支付接口
3. 订单信息安全存储
4. 支付结果验证机制

## 7. 性能要求

1. 页面加载时间：首屏加载不超过3秒
2. 响应时间：用户操作响应不超过1秒
3. 并发处理：支持至少100用户同时在线
4. 可用性：系统可用性达到99.9%
5. AI响应时间：分析结果返回不超过30秒

## 8. 开发与部署计划

### 8.1 开发阶段

1. 需求分析与设计：2周
2. 前端开发：3周
3. 后端开发：4周
4. 集成测试：2周
5. 用户测试与优化：2周

### 8.2 部署阶段

1. 环境准备：1周
2. 系统部署：1周
3. 上线测试：1周
4. 正式发布：1天

### 8.3 维护计划

1. 定期系统更新
2. 用户反馈收集与功能优化
3. 安全漏洞修复
4. 性能监控与优化

## 9. 风险评估与应对策略

### 9.1 技术风险

1. AI接口不稳定：准备备用API或本地模型
2. 支付接口异常：实现支付状态轮询和手动确认机制
3. 服务器负载过高：实现弹性扩容和负载均衡

### 9.2 业务风险

1. 用户接受度不高：加强产品宣传和用户教育
2. 竞品模仿：持续创新和优化用户体验
3. 政策法规变化：密切关注相关政策，及时调整

## 10. 验收标准

1. 功能完整性：所有需求功能正常运行
2. 用户体验：界面友好，操作流畅
3. 性能达标：符合性能要求
4. 安全可靠：数据安全，支付可靠
5. 兼容性：支持主流浏览器和移动设备

## 11. 附录

### 11.1 术语表

- 八字：指年、月、日、时四柱，每柱由天干和地支组成
- 真太阳时：根据太阳实际位置计算的时间
- 流年大运：命理学中的运势变化周期
- API：应用程序接口
- H5：HTML5，用于开发移动端网页

### 11.2 参考资料

- 开源万年历数据来源
- 八字命理理论参考文献
- ChatGPT API文档
- 微信支付和支付宝开发文档

---

本需求说明书由项目团队制定，作为开发工作的指导文件。在实际开发过程中，可能会根据具体情况进行适当调整和优化。
