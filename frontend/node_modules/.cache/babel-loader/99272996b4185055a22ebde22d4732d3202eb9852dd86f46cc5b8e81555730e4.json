{"ast":null,"code":"import { ref, onMounted } from 'vue';\nimport { useRoute, useRouter } from 'vue-router';\nimport { showToast } from 'vant';\nimport { jsPDF } from 'jspdf';\nimport html2canvas from 'html2canvas';\nimport axios from 'axios';\nimport http from './api/http'; // 导入配置好的http实例\n\nexport default {\n  __name: 'Result',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const route = useRoute();\n    const router = useRouter();\n    const resultId = route.params.id || route.query.resultId;\n    const activeTab = ref(0);\n\n    // 模拟数据，作为API调用失败时的备用数据\n    const focusAreas = ref(['health', 'wealth', 'career', 'relationship']);\n\n    // 备用数据，只在API调用失败时使用\n    const baziData = ref({\n      yearPillar: {\n        heavenlyStem: '甲',\n        earthlyBranch: '子',\n        element: '水'\n      },\n      monthPillar: {\n        heavenlyStem: '丙',\n        earthlyBranch: '寅',\n        element: '木'\n      },\n      dayPillar: {\n        heavenlyStem: '戊',\n        earthlyBranch: '午',\n        element: '火'\n      },\n      hourPillar: {\n        heavenlyStem: '庚',\n        earthlyBranch: '申',\n        element: '金'\n      },\n      fiveElements: {\n        wood: 2,\n        fire: 2,\n        earth: 1,\n        metal: 2,\n        water: 1\n      },\n      flowingYears: [{\n        year: 2025,\n        heavenlyStem: '乙',\n        earthlyBranch: '丑',\n        element: '土'\n      }, {\n        year: 2026,\n        heavenlyStem: '丙',\n        earthlyBranch: '寅',\n        element: '木'\n      }, {\n        year: 2027,\n        heavenlyStem: '丁',\n        earthlyBranch: '卯',\n        element: '木'\n      }, {\n        year: 2028,\n        heavenlyStem: '戊',\n        earthlyBranch: '辰',\n        element: '土'\n      }, {\n        year: 2029,\n        heavenlyStem: '己',\n        earthlyBranch: '巳',\n        element: '火'\n      }]\n    });\n\n    // 备用分析数据，只在API调用失败时使用\n    const aiAnalysis = ref({\n      health: '您的八字中火土较旺，木水偏弱。从健康角度看，您需要注意心脑血管系统和消化系统的保养。建议平时多喝水，保持规律作息，避免过度劳累和情绪波动。2025-2026年间需特别注意肝胆健康，可适当增加绿色蔬菜的摄入，定期体检。',\n      wealth: '您的财运在2025年有明显上升趋势，特别是在春夏季节。八字中金水相生，适合从事金融、贸易、水利相关行业。投资方面，稳健为主，可考虑分散投资组合。2027年有意外财运，但需谨慎对待，避免投机性强的项目。',\n      career: '您的事业宫位较为稳定，具有较强的组织能力和执行力。2025-2026年是事业发展的关键期，有升职或转行的机会。建议提升专业技能，扩展人脉关系。您适合在团队中担任协调或管理角色，发挥沟通才能。',\n      relationship: '您的八字中日柱为戊午，感情态度较为务实。2025年下半年至2026年上半年是感情发展的良好时期。已婚者需注意与伴侣的沟通，避免因工作忙碌而忽略家庭。单身者有机会通过社交活动或朋友介绍认识合适的对象。',\n      children: '您的子女宫位较为温和，与子女关系和谐。教育方面，建议采用引导式而非强制式的方法，尊重子女的兴趣发展。2026-2027年是子女发展的重要阶段，可能需要您更多的关注和支持。',\n      overall: '综合分析您的八字，2025-2027年是您人生的一个上升期，各方面都有良好发展。建议把握这段时间，在事业上积极进取，在健康上注意保养，在人际关系上广结善缘。您的人生态度积极乐观，具有较强的适应能力和抗压能力，这将帮助您度过人生中的各种挑战。'\n    });\n    const testApiConnection = async () => {\n      try {\n        showToast('正在测试API连接...');\n        // 使用配置好的http实例\n        const response = await http.get('/');\n        console.log('API根路径响应:', response.data);\n        showToast('API连接成功');\n        return true;\n      } catch (error) {\n        console.error('API连接测试失败:', error);\n        showToast('API连接失败，请检查后端服务');\n        return false;\n      }\n    };\n    onMounted(async () => {\n      // 先测试API连接\n      const isApiConnected = await testApiConnection();\n      if (!isApiConnected) {\n        console.warn('API连接失败，将使用模拟数据');\n        return;\n      }\n      console.log('结果页面加载，ID:', resultId);\n\n      // 如果没有resultId，尝试从本地存储获取\n      const localResultId = localStorage.getItem('resultId');\n      if (!resultId && localResultId) {\n        console.log('从本地存储获取ID:', localResultId);\n      }\n      const finalResultId = resultId || localResultId;\n      if (!finalResultId) {\n        console.error('缺少结果ID，无法获取分析结果');\n        showToast('缺少结果ID，无法获取分析结果');\n        return;\n      }\n      try {\n        console.log('调用API获取结果:', `/api/bazi/result/${finalResultId}`);\n\n        // 显示加载提示，提醒用户需要等待\n        showToast({\n          message: '正在调用AI进行八字分析，请耐心等待30-60秒...',\n          duration: 10000,\n          position: 'middle'\n        });\n\n        // 使用配置好的http实例\n        const response = await http.get(`/api/bazi/result/${finalResultId}`);\n        console.log('API响应:', response.status, response.data);\n        if (response.data.code === 200) {\n          console.log('获取成功，更新数据');\n          // 确保从API获取数据并更新视图\n          baziData.value = response.data.data.baziChart;\n          aiAnalysis.value = response.data.data.aiAnalysis;\n          focusAreas.value = response.data.data.focusAreas;\n          showToast('分析结果加载成功');\n        } else {\n          console.error('API返回错误:', response.data.message);\n          showToast(response.data.message || '获取分析结果失败');\n        }\n      } catch (error) {\n        console.error('获取分析结果出错:', error);\n        console.error('错误详情:', error.response ? error.response.data : '无响应数据');\n        showToast('获取分析结果失败，请稍后重试');\n\n        // 备选方案：如果ID以\"RES\"开头，尝试模拟支付再获取结果\n        if (finalResultId.startsWith('RES')) {\n          try {\n            console.log('尝试使用模拟支付接口...');\n            const orderId = finalResultId.replace('RES', '');\n            const mockPaymentResponse = await http.post(`/api/order/mock/pay/${orderId}`);\n            if (mockPaymentResponse.data.code === 200 && mockPaymentResponse.data.data.resultId) {\n              const newResultId = mockPaymentResponse.data.data.resultId;\n              console.log('获取到新的resultId:', newResultId);\n              const retryResponse = await http.get(`/api/bazi/result/${newResultId}`);\n              if (retryResponse.data.code === 200) {\n                baziData.value = retryResponse.data.data.baziChart;\n                aiAnalysis.value = retryResponse.data.data.aiAnalysis;\n                focusAreas.value = retryResponse.data.data.focusAreas;\n                showToast('分析结果加载成功');\n                return;\n              }\n            }\n          } catch (mockError) {\n            console.error('模拟支付失败:', mockError);\n          }\n        }\n      }\n    });\n    const getElementName = element => {\n      const elementNames = {\n        wood: '木',\n        fire: '火',\n        earth: '土',\n        metal: '金',\n        water: '水'\n      };\n      return elementNames[element] || element;\n    };\n    const onClickLeft = () => {\n      router.push('/');\n    };\n    const downloadPDF = () => {\n      showToast('正在生成PDF，请稍候...');\n\n      // 实际项目中应该调用后端API下载PDF\n      // 这里仅做前端演示\n      setTimeout(() => {\n        showToast('PDF生成成功，开始下载');\n      }, 1500);\n    };\n    const shareResult = () => {\n      showToast('分享功能开发中');\n    };\n    const reloadBaziData = async () => {\n      showToast('正在重新加载数据...');\n      try {\n        // 测试模拟支付接口以获取分析结果\n        if (!resultId) {\n          showToast('缺少结果ID');\n          return;\n        }\n\n        // 首先尝试使用模拟支付接口\n        try {\n          console.log('尝试使用模拟支付接口...');\n          const mockPaymentResponse = await http.post(`/api/order/mock/pay/${resultId.replace('RES', '')}`);\n          console.log('模拟支付响应:', mockPaymentResponse.data);\n          if (mockPaymentResponse.data.code === 200 && mockPaymentResponse.data.data.resultId) {\n            // 使用返回的resultId重新加载数据\n            const newResultId = mockPaymentResponse.data.data.resultId;\n            console.log('获取到新的resultId:', newResultId);\n            const response = await http.get(`/api/bazi/result/${newResultId}`);\n            if (response.data.code === 200) {\n              baziData.value = response.data.data.baziChart;\n              aiAnalysis.value = response.data.data.aiAnalysis;\n              focusAreas.value = response.data.data.focusAreas;\n              showToast('数据加载成功');\n              return;\n            }\n          }\n        } catch (mockError) {\n          console.warn('模拟支付失败，尝试直接获取结果:', mockError);\n        }\n\n        // 如果模拟支付失败，尝试直接获取结果\n        const response = await http.get(`/api/bazi/result/${resultId}`);\n        if (response.data.code === 200) {\n          baziData.value = response.data.data.baziChart;\n          aiAnalysis.value = response.data.data.aiAnalysis;\n          focusAreas.value = response.data.data.focusAreas;\n          showToast('数据加载成功');\n        } else {\n          showToast(response.data.message || '加载失败');\n        }\n      } catch (error) {\n        console.error('重新加载失败:', error);\n        showToast('加载失败: ' + (error.message || '未知错误'));\n      }\n    };\n    const __returned__ = {\n      route,\n      router,\n      resultId,\n      activeTab,\n      focusAreas,\n      baziData,\n      aiAnalysis,\n      testApiConnection,\n      getElementName,\n      onClickLeft,\n      downloadPDF,\n      shareResult,\n      reloadBaziData,\n      ref,\n      onMounted,\n      get useRoute() {\n        return useRoute;\n      },\n      get useRouter() {\n        return useRouter;\n      },\n      get showToast() {\n        return showToast;\n      },\n      get jsPDF() {\n        return jsPDF;\n      },\n      get html2canvas() {\n        return html2canvas;\n      },\n      get axios() {\n        return axios;\n      },\n      get http() {\n        return http;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","useRoute","useRouter","showToast","jsPDF","html2canvas","axios","http","route","router","resultId","params","id","query","activeTab","focusAreas","baziData","yearPillar","heavenlyStem","earthlyBranch","element","monthPillar","dayPillar","hourPillar","fiveElements","wood","fire","earth","metal","water","flowingYears","year","aiAnalysis","health","wealth","career","relationship","children","overall","testApiConnection","response","get","console","log","data","error","isApiConnected","warn","localResultId","localStorage","getItem","finalResultId","message","duration","position","status","code","value","baziChart","startsWith","orderId","replace","mockPaymentResponse","post","newResultId","retryResponse","mockError","getElementName","elementNames","onClickLeft","push","downloadPDF","setTimeout","shareResult","reloadBaziData"],"sources":["C:/Users/123/Desktop/开发八字命理AI指导功能页码/frontend/src/Result.vue"],"sourcesContent":["<template>\n  <div class=\"result-container\">\n    <van-nav-bar\n      title=\"八字分析结果\"\n      left-text=\"返回\"\n      left-arrow\n      @click-left=\"onClickLeft\"\n    />\n    \n    <div class=\"result-header\">\n      <h2>您的八字命盘分析</h2>\n      <p>基于您的出生信息，AI为您提供的个性化人生指导</p>\n    </div>\n    \n    <van-tabs v-model=\"activeTab\" sticky>\n      <van-tab title=\"命盘信息\">\n        <div class=\"bazi-chart\">\n          <h3>八字命盘</h3>\n          <van-grid :column-num=\"4\" :border=\"false\">\n            <van-grid-item>\n              <template #default>\n                <div class=\"pillar\">\n                  <div class=\"stem\">{{ baziData.yearPillar.heavenlyStem }}</div>\n                  <div class=\"branch\">{{ baziData.yearPillar.earthlyBranch }}</div>\n                  <div class=\"label\">年柱</div>\n                </div>\n              </template>\n            </van-grid-item>\n            <van-grid-item>\n              <template #default>\n                <div class=\"pillar\">\n                  <div class=\"stem\">{{ baziData.monthPillar.heavenlyStem }}</div>\n                  <div class=\"branch\">{{ baziData.monthPillar.earthlyBranch }}</div>\n                  <div class=\"label\">月柱</div>\n                </div>\n              </template>\n            </van-grid-item>\n            <van-grid-item>\n              <template #default>\n                <div class=\"pillar\">\n                  <div class=\"stem\">{{ baziData.dayPillar.heavenlyStem }}</div>\n                  <div class=\"branch\">{{ baziData.dayPillar.earthlyBranch }}</div>\n                  <div class=\"label\">日柱</div>\n                </div>\n              </template>\n            </van-grid-item>\n            <van-grid-item>\n              <template #default>\n                <div class=\"pillar\">\n                  <div class=\"stem\">{{ baziData.hourPillar.heavenlyStem }}</div>\n                  <div class=\"branch\">{{ baziData.hourPillar.earthlyBranch }}</div>\n                  <div class=\"label\">时柱</div>\n                </div>\n              </template>\n            </van-grid-item>\n          </van-grid>\n          \n          <h3>五行分布</h3>\n          <div class=\"five-elements\">\n            <div class=\"element\" v-for=\"(value, element) in baziData.fiveElements\" :key=\"element\">\n              <div class=\"element-name\">{{ getElementName(element) }}</div>\n              <div class=\"element-value\">{{ value }}</div>\n            </div>\n          </div>\n          \n          <h3>大运流年</h3>\n          <div class=\"flowing-years\">\n            <van-steps direction=\"horizontal\" :active=\"2\">\n              <van-step v-for=\"(year, index) in baziData.flowingYears.slice(0, 5)\" :key=\"index\">\n                {{ year.year }}年<br>\n                {{ year.heavenlyStem }}{{ year.earthlyBranch }}\n              </van-step>\n            </van-steps>\n          </div>\n        </div>\n      </van-tab>\n      \n      <van-tab title=\"AI分析结果\">\n        <div class=\"ai-analysis\">\n          <template v-if=\"focusAreas.includes('health')\">\n            <div class=\"analysis-section\">\n              <h3>身体健康</h3>\n              <p>{{ aiAnalysis.health }}</p>\n            </div>\n          </template>\n          \n          <template v-if=\"focusAreas.includes('wealth')\">\n            <div class=\"analysis-section\">\n              <h3>财运分析</h3>\n              <p>{{ aiAnalysis.wealth }}</p>\n            </div>\n          </template>\n          \n          <template v-if=\"focusAreas.includes('career')\">\n            <div class=\"analysis-section\">\n              <h3>事业发展</h3>\n              <p>{{ aiAnalysis.career }}</p>\n            </div>\n          </template>\n          \n          <template v-if=\"focusAreas.includes('relationship')\">\n            <div class=\"analysis-section\">\n              <h3>婚姻感情</h3>\n              <p>{{ aiAnalysis.relationship }}</p>\n            </div>\n          </template>\n          \n          <template v-if=\"focusAreas.includes('children')\">\n            <div class=\"analysis-section\">\n              <h3>子女缘分</h3>\n              <p>{{ aiAnalysis.children }}</p>\n            </div>\n          </template>\n          \n          <div class=\"analysis-section\">\n            <h3>综合建议</h3>\n            <p>{{ aiAnalysis.overall }}</p>\n          </div>\n        </div>\n      </van-tab>\n    </van-tabs>\n    \n    <div class=\"action-buttons\">\n      <van-button type=\"primary\" block @click=\"downloadPDF\">\n        下载PDF报告\n      </van-button>\n      <van-button plain type=\"primary\" block style=\"margin-top: 10px;\" @click=\"shareResult\">\n        分享结果\n      </van-button>\n      \n      <!-- 调试按钮 -->\n      <van-button plain type=\"warning\" \n                  block \n                  style=\"margin-top: 10px;\" \n                  @click=\"reloadBaziData\">\n        重新加载分析数据\n      </van-button>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue';\nimport { useRoute, useRouter } from 'vue-router';\nimport { showToast } from 'vant';\nimport { jsPDF } from 'jspdf';\nimport html2canvas from 'html2canvas';\nimport axios from 'axios';\nimport http from './api/http'; // 导入配置好的http实例\n\nconst route = useRoute();\nconst router = useRouter();\nconst resultId = route.params.id || route.query.resultId;\nconst activeTab = ref(0);\n\n// 模拟数据，作为API调用失败时的备用数据\nconst focusAreas = ref(['health', 'wealth', 'career', 'relationship']);\n\n// 备用数据，只在API调用失败时使用\nconst baziData = ref({\n  yearPillar: {\n    heavenlyStem: '甲',\n    earthlyBranch: '子',\n    element: '水'\n  },\n  monthPillar: {\n    heavenlyStem: '丙',\n    earthlyBranch: '寅',\n    element: '木'\n  },\n  dayPillar: {\n    heavenlyStem: '戊',\n    earthlyBranch: '午',\n    element: '火'\n  },\n  hourPillar: {\n    heavenlyStem: '庚',\n    earthlyBranch: '申',\n    element: '金'\n  },\n  fiveElements: {\n    wood: 2,\n    fire: 2,\n    earth: 1,\n    metal: 2,\n    water: 1\n  },\n  flowingYears: [\n    {\n      year: 2025,\n      heavenlyStem: '乙',\n      earthlyBranch: '丑',\n      element: '土'\n    },\n    {\n      year: 2026,\n      heavenlyStem: '丙',\n      earthlyBranch: '寅',\n      element: '木'\n    },\n    {\n      year: 2027,\n      heavenlyStem: '丁',\n      earthlyBranch: '卯',\n      element: '木'\n    },\n    {\n      year: 2028,\n      heavenlyStem: '戊',\n      earthlyBranch: '辰',\n      element: '土'\n    },\n    {\n      year: 2029,\n      heavenlyStem: '己',\n      earthlyBranch: '巳',\n      element: '火'\n    }\n  ]\n});\n\n// 备用分析数据，只在API调用失败时使用\nconst aiAnalysis = ref({\n  health: '您的八字中火土较旺，木水偏弱。从健康角度看，您需要注意心脑血管系统和消化系统的保养。建议平时多喝水，保持规律作息，避免过度劳累和情绪波动。2025-2026年间需特别注意肝胆健康，可适当增加绿色蔬菜的摄入，定期体检。',\n  wealth: '您的财运在2025年有明显上升趋势，特别是在春夏季节。八字中金水相生，适合从事金融、贸易、水利相关行业。投资方面，稳健为主，可考虑分散投资组合。2027年有意外财运，但需谨慎对待，避免投机性强的项目。',\n  career: '您的事业宫位较为稳定，具有较强的组织能力和执行力。2025-2026年是事业发展的关键期，有升职或转行的机会。建议提升专业技能，扩展人脉关系。您适合在团队中担任协调或管理角色，发挥沟通才能。',\n  relationship: '您的八字中日柱为戊午，感情态度较为务实。2025年下半年至2026年上半年是感情发展的良好时期。已婚者需注意与伴侣的沟通，避免因工作忙碌而忽略家庭。单身者有机会通过社交活动或朋友介绍认识合适的对象。',\n  children: '您的子女宫位较为温和，与子女关系和谐。教育方面，建议采用引导式而非强制式的方法，尊重子女的兴趣发展。2026-2027年是子女发展的重要阶段，可能需要您更多的关注和支持。',\n  overall: '综合分析您的八字，2025-2027年是您人生的一个上升期，各方面都有良好发展。建议把握这段时间，在事业上积极进取，在健康上注意保养，在人际关系上广结善缘。您的人生态度积极乐观，具有较强的适应能力和抗压能力，这将帮助您度过人生中的各种挑战。'\n});\n\nconst testApiConnection = async () => {\n  try {\n    showToast('正在测试API连接...');\n    // 使用配置好的http实例\n    const response = await http.get('/');\n    console.log('API根路径响应:', response.data);\n    showToast('API连接成功');\n    return true;\n  } catch (error) {\n    console.error('API连接测试失败:', error);\n    showToast('API连接失败，请检查后端服务');\n    return false;\n  }\n};\n\nonMounted(async () => {\n  // 先测试API连接\n  const isApiConnected = await testApiConnection();\n  if (!isApiConnected) {\n    console.warn('API连接失败，将使用模拟数据');\n    return;\n  }\n  \n  console.log('结果页面加载，ID:', resultId);\n  \n  // 如果没有resultId，尝试从本地存储获取\n  const localResultId = localStorage.getItem('resultId');\n  if (!resultId && localResultId) {\n    console.log('从本地存储获取ID:', localResultId);\n  }\n  \n  const finalResultId = resultId || localResultId;\n  \n  if (!finalResultId) {\n    console.error('缺少结果ID，无法获取分析结果');\n    showToast('缺少结果ID，无法获取分析结果');\n    return;\n  }\n  \n  try {\n    console.log('调用API获取结果:', `/api/bazi/result/${finalResultId}`);\n    \n    // 显示加载提示，提醒用户需要等待\n    showToast({\n      message: '正在调用AI进行八字分析，请耐心等待30-60秒...',\n      duration: 10000,\n      position: 'middle'\n    });\n    \n    // 使用配置好的http实例\n    const response = await http.get(`/api/bazi/result/${finalResultId}`);\n    \n    console.log('API响应:', response.status, response.data);\n    \n    if (response.data.code === 200) {\n      console.log('获取成功，更新数据');\n      // 确保从API获取数据并更新视图\n      baziData.value = response.data.data.baziChart;\n      aiAnalysis.value = response.data.data.aiAnalysis;\n      focusAreas.value = response.data.data.focusAreas;\n      showToast('分析结果加载成功');\n    } else {\n      console.error('API返回错误:', response.data.message);\n      showToast(response.data.message || '获取分析结果失败');\n    }\n  } catch (error) {\n    console.error('获取分析结果出错:', error);\n    console.error('错误详情:', error.response ? error.response.data : '无响应数据');\n    showToast('获取分析结果失败，请稍后重试');\n    \n    // 备选方案：如果ID以\"RES\"开头，尝试模拟支付再获取结果\n    if (finalResultId.startsWith('RES')) {\n      try {\n        console.log('尝试使用模拟支付接口...');\n        const orderId = finalResultId.replace('RES', '');\n        const mockPaymentResponse = await http.post(`/api/order/mock/pay/${orderId}`);\n        \n        if (mockPaymentResponse.data.code === 200 && mockPaymentResponse.data.data.resultId) {\n          const newResultId = mockPaymentResponse.data.data.resultId;\n          console.log('获取到新的resultId:', newResultId);\n          \n          const retryResponse = await http.get(`/api/bazi/result/${newResultId}`);\n          if (retryResponse.data.code === 200) {\n            baziData.value = retryResponse.data.data.baziChart;\n            aiAnalysis.value = retryResponse.data.data.aiAnalysis;\n            focusAreas.value = retryResponse.data.data.focusAreas;\n            showToast('分析结果加载成功');\n            return;\n          }\n        }\n      } catch (mockError) {\n        console.error('模拟支付失败:', mockError);\n      }\n    }\n  }\n});\n\nconst getElementName = (element) => {\n  const elementNames = {\n    wood: '木',\n    fire: '火',\n    earth: '土',\n    metal: '金',\n    water: '水'\n  };\n  return elementNames[element] || element;\n};\n\nconst onClickLeft = () => {\n  router.push('/');\n};\n\nconst downloadPDF = () => {\n  showToast('正在生成PDF，请稍候...');\n  \n  // 实际项目中应该调用后端API下载PDF\n  // 这里仅做前端演示\n  setTimeout(() => {\n    showToast('PDF生成成功，开始下载');\n  }, 1500);\n};\n\nconst shareResult = () => {\n  showToast('分享功能开发中');\n};\n\nconst reloadBaziData = async () => {\n  showToast('正在重新加载数据...');\n  \n  try {\n    // 测试模拟支付接口以获取分析结果\n    if (!resultId) {\n      showToast('缺少结果ID');\n      return;\n    }\n    \n    // 首先尝试使用模拟支付接口\n    try {\n      console.log('尝试使用模拟支付接口...');\n      const mockPaymentResponse = await http.post(`/api/order/mock/pay/${resultId.replace('RES', '')}`);\n      console.log('模拟支付响应:', mockPaymentResponse.data);\n      \n      if (mockPaymentResponse.data.code === 200 && mockPaymentResponse.data.data.resultId) {\n        // 使用返回的resultId重新加载数据\n        const newResultId = mockPaymentResponse.data.data.resultId;\n        console.log('获取到新的resultId:', newResultId);\n        \n        const response = await http.get(`/api/bazi/result/${newResultId}`);\n        if (response.data.code === 200) {\n          baziData.value = response.data.data.baziChart;\n          aiAnalysis.value = response.data.data.aiAnalysis;\n          focusAreas.value = response.data.data.focusAreas;\n          showToast('数据加载成功');\n          return;\n        }\n      }\n    } catch (mockError) {\n      console.warn('模拟支付失败，尝试直接获取结果:', mockError);\n    }\n    \n    // 如果模拟支付失败，尝试直接获取结果\n    const response = await http.get(`/api/bazi/result/${resultId}`);\n    \n    if (response.data.code === 200) {\n      baziData.value = response.data.data.baziChart;\n      aiAnalysis.value = response.data.data.aiAnalysis;\n      focusAreas.value = response.data.data.focusAreas;\n      showToast('数据加载成功');\n    } else {\n      showToast(response.data.message || '加载失败');\n    }\n  } catch (error) {\n    console.error('重新加载失败:', error);\n    showToast('加载失败: ' + (error.message || '未知错误'));\n  }\n};\n</script>\n\n<style scoped>\n.result-container {\n  padding-bottom: 20px;\n}\n\n.result-header {\n  text-align: center;\n  padding: 20px 0;\n  background-color: #f2f3f5;\n}\n\n.result-header h2 {\n  margin: 0;\n  font-size: 20px;\n  color: #323233;\n}\n\n.result-header p {\n  margin: 10px 0 0;\n  font-size: 14px;\n  color: #969799;\n}\n\n.bazi-chart {\n  padding: 20px 16px;\n}\n\n.bazi-chart h3 {\n  margin: 20px 0 10px;\n  color: #323233;\n}\n\n.pillar {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n\n.stem {\n  width: 40px;\n  height: 40px;\n  line-height: 40px;\n  text-align: center;\n  background-color: #1989fa;\n  color: white;\n  border-radius: 4px;\n  margin-bottom: 5px;\n}\n\n.branch {\n  width: 40px;\n  height: 40px;\n  line-height: 40px;\n  text-align: center;\n  background-color: #07c160;\n  color: white;\n  border-radius: 4px;\n  margin-bottom: 5px;\n}\n\n.label {\n  font-size: 12px;\n  color: #646566;\n}\n\n.five-elements {\n  display: flex;\n  justify-content: space-between;\n  margin: 10px 0;\n}\n\n.element {\n  text-align: center;\n  flex: 1;\n}\n\n.element-name {\n  font-size: 14px;\n  color: #323233;\n}\n\n.element-value {\n  font-size: 18px;\n  font-weight: bold;\n  color: #1989fa;\n  margin-top: 5px;\n}\n\n.flowing-years {\n  margin: 20px 0;\n}\n\n.ai-analysis {\n  padding: 20px 16px;\n}\n\n.analysis-section {\n  margin-bottom: 20px;\n}\n\n.analysis-section h3 {\n  margin: 0 0 10px;\n  color: #323233;\n}\n\n.analysis-section p {\n  margin: 0;\n  font-size: 14px;\n  color: #646566;\n  line-height: 1.6;\n}\n\n.action-buttons {\n  padding: 20px 16px;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}