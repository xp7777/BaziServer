(()=>{"use strict";var e={6709:(e,a,l)=>{var t=l(5130),n=l(1387),s=l(3367),i=l(6768),o=l(144);const r={class:"app-container"},u={__name:"App",setup(e){const a=(0,o.KR)(0);return(e,l)=>{const t=(0,i.g2)("router-view"),n=(0,i.g2)("van-tabbar-item"),s=(0,i.g2)("van-tabbar");return(0,i.uX)(),(0,i.CE)("div",r,[(0,i.bF)(t),(0,i.bF)(s,{modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=e=>a.value=e),route:""},{default:(0,i.k6)((()=>[(0,i.bF)(n,{icon:"home-o",to:"/"},{default:(0,i.k6)((()=>l[1]||(l[1]=[(0,i.eW)("首页")]))),_:1,__:[1]}),(0,i.bF)(n,{icon:"user-o",to:"/user"},{default:(0,i.k6)((()=>l[2]||(l[2]=[(0,i.eW)("我的")]))),_:1,__:[2]})])),_:1},8,["modelValue"])])}}},c=u,d=c;var v=l(4232);const h=l.p+"img/banner.1e50378e.png";var y=l(791);const p={class:"home-container"},k=["value"],g={style:{margin:"16px"}},m={class:"intro-section"},f={__name:"Home",setup(e){const a=(0,n.rd)(),l=[{text:"子时 (23:00-01:00)"},{text:"丑时 (01:00-03:00)"},{text:"寅时 (03:00-05:00)"},{text:"卯时 (05:00-07:00)"},{text:"辰时 (07:00-09:00)"},{text:"巳时 (09:00-11:00)"},{text:"午时 (11:00-13:00)"},{text:"未时 (13:00-15:00)"},{text:"申时 (15:00-17:00)"},{text:"酉时 (17:00-19:00)"},{text:"戌时 (19:00-21:00)"},{text:"亥时 (21:00-23:00)"}],s=(0,o.Kh)({gender:"male",calendarType:"solar",birthDate:"",birthTime:"",birthPlace:"",livingPlace:"",focusAreas:[]}),r=()=>{s.birthDate?s.birthTime?s.birthPlace?s.livingPlace?0!==s.focusAreas.length?(console.log("提交数据:",s),a.push({path:"/payment",query:{gender:s.gender,calendarType:s.calendarType,birthDate:s.birthDate,birthTime:s.birthTime,birthPlace:s.birthPlace,livingPlace:s.livingPlace,focusAreas:s.focusAreas.join(",")}})):y.y.fail("请至少选择一个推算侧重点"):y.y.fail("请填写居住地"):y.y.fail("请填写出生地"):y.y.fail("请选择出生时辰"):y.y.fail("请选择出生日期")};return(e,a)=>{const n=(0,i.g2)("van-nav-bar"),o=(0,i.g2)("van-radio"),u=(0,i.g2)("van-radio-group"),c=(0,i.g2)("van-field"),d=(0,i.g2)("van-checkbox"),y=(0,i.g2)("van-checkbox-group"),f=(0,i.g2)("van-cell-group"),b=(0,i.g2)("van-button"),_=(0,i.g2)("van-form"),L=(0,i.g2)("van-step"),w=(0,i.g2)("van-steps");return(0,i.uX)(),(0,i.CE)("div",p,[(0,i.bF)(n,{title:"八字命理AI人生指导"}),a[25]||(a[25]=(0,i.Lk)("div",{class:"banner"},[(0,i.Lk)("img",{src:h,alt:"八字命理AI人生指导",class:"banner-img"}),(0,i.Lk)("h2",{class:"slogan"},"传统命理 · 现代科技 · 智慧人生")],-1)),(0,i.bF)(_,{onSubmit:r},{default:(0,i.k6)((()=>[(0,i.bF)(f,{inset:""},{default:(0,i.k6)((()=>[(0,i.bF)(c,{name:"gender",label:"性别"},{input:(0,i.k6)((()=>[(0,i.bF)(u,{modelValue:s.gender,"onUpdate:modelValue":a[0]||(a[0]=e=>s.gender=e),direction:"horizontal"},{default:(0,i.k6)((()=>[(0,i.bF)(o,{name:"male"},{default:(0,i.k6)((()=>a[7]||(a[7]=[(0,i.eW)("男")]))),_:1,__:[7]}),(0,i.bF)(o,{name:"female"},{default:(0,i.k6)((()=>a[8]||(a[8]=[(0,i.eW)("女")]))),_:1,__:[8]})])),_:1},8,["modelValue"])])),_:1}),(0,i.bF)(c,{name:"calendarType",label:"历法选择"},{input:(0,i.k6)((()=>[(0,i.bF)(u,{modelValue:s.calendarType,"onUpdate:modelValue":a[1]||(a[1]=e=>s.calendarType=e),direction:"horizontal"},{default:(0,i.k6)((()=>[(0,i.bF)(o,{name:"solar"},{default:(0,i.k6)((()=>a[9]||(a[9]=[(0,i.eW)("公历")]))),_:1,__:[9]}),(0,i.bF)(o,{name:"lunar"},{default:(0,i.k6)((()=>a[10]||(a[10]=[(0,i.eW)("农历")]))),_:1,__:[10]})])),_:1},8,["modelValue"])])),_:1}),(0,i.bF)(c,{name:"birthDate",label:"出生日期"},{input:(0,i.k6)((()=>[(0,i.bo)((0,i.Lk)("input",{type:"date","onUpdate:modelValue":a[2]||(a[2]=e=>s.birthDate=e),min:"1900-01-01",max:"2100-12-31",class:"native-date-picker"},null,512),[[t.Jo,s.birthDate]])])),_:1}),(0,i.bF)(c,{name:"birthTime",label:"出生时辰"},{input:(0,i.k6)((()=>[(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":a[3]||(a[3]=e=>s.birthTime=e),class:"native-time-picker"},[a[11]||(a[11]=(0,i.Lk)("option",{value:""},"请选择时辰",-1)),((0,i.uX)(),(0,i.CE)(i.FK,null,(0,i.pI)(l,((e,a)=>(0,i.Lk)("option",{key:a,value:e.text},(0,v.v_)(e.text),9,k))),64))],512),[[t.u1,s.birthTime]])])),_:1}),(0,i.bF)(c,{modelValue:s.birthPlace,"onUpdate:modelValue":a[4]||(a[4]=e=>s.birthPlace=e),name:"birthPlace",label:"出生地",placeholder:"请输入出生地（如：北京市海淀区）",rules:[{required:!0,message:"请填写出生地"}]},null,8,["modelValue"]),(0,i.bF)(c,{modelValue:s.livingPlace,"onUpdate:modelValue":a[5]||(a[5]=e=>s.livingPlace=e),name:"livingPlace",label:"居住地",placeholder:"请输入当前居住地（如：上海市浦东新区）",rules:[{required:!0,message:"请填写居住地"}]},null,8,["modelValue"]),(0,i.bF)(c,{name:"focusAreas",label:"推算侧重点"},{input:(0,i.k6)((()=>[(0,i.bF)(y,{modelValue:s.focusAreas,"onUpdate:modelValue":a[6]||(a[6]=e=>s.focusAreas=e),direction:"horizontal"},{default:(0,i.k6)((()=>[(0,i.bF)(d,{name:"health"},{default:(0,i.k6)((()=>a[12]||(a[12]=[(0,i.eW)("身体健康")]))),_:1,__:[12]}),(0,i.bF)(d,{name:"wealth"},{default:(0,i.k6)((()=>a[13]||(a[13]=[(0,i.eW)("财运")]))),_:1,__:[13]}),(0,i.bF)(d,{name:"career"},{default:(0,i.k6)((()=>a[14]||(a[14]=[(0,i.eW)("事业")]))),_:1,__:[14]}),(0,i.bF)(d,{name:"relationship"},{default:(0,i.k6)((()=>a[15]||(a[15]=[(0,i.eW)("婚姻感情")]))),_:1,__:[15]}),(0,i.bF)(d,{name:"children"},{default:(0,i.k6)((()=>a[16]||(a[16]=[(0,i.eW)("子女")]))),_:1,__:[16]})])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,i.Lk)("div",g,[(0,i.bF)(b,{round:"",block:"",type:"primary","native-type":"submit"},{default:(0,i.k6)((()=>a[17]||(a[17]=[(0,i.eW)(" 提交并支付 (9.9元) ")]))),_:1,__:[17]})])])),_:1}),(0,i.Lk)("div",m,[a[22]||(a[22]=(0,i.Lk)("h3",null,"八字命理AI人生指导系统",-1)),a[23]||(a[23]=(0,i.Lk)("p",null,"本系统结合传统八字命理理论与现代人工智能技术，为您提供个性化的人生指导建议。通过分析您的八字命盘和流年大运信息，AI将为您解读人生各方面的发展趋势和潜在机遇。",-1)),a[24]||(a[24]=(0,i.Lk)("h3",null,"使用流程",-1)),(0,i.bF)(w,{direction:"vertical",active:0},{default:(0,i.k6)((()=>[(0,i.bF)(L,null,{default:(0,i.k6)((()=>a[18]||(a[18]=[(0,i.Lk)("h3",null,"填写信息",-1),(0,i.Lk)("p",null,"输入性别、出生年月日时、出生地、居住地和关注领域",-1)]))),_:1,__:[18]}),(0,i.bF)(L,null,{default:(0,i.k6)((()=>a[19]||(a[19]=[(0,i.Lk)("h3",null,"完成支付",-1),(0,i.Lk)("p",null,"支付9.9元获取专业分析",-1)]))),_:1,__:[19]}),(0,i.bF)(L,null,{default:(0,i.k6)((()=>a[20]||(a[20]=[(0,i.Lk)("h3",null,"AI分析",-1),(0,i.Lk)("p",null,"系统计算八字并通过AI进行解读",-1)]))),_:1,__:[20]}),(0,i.bF)(L,null,{default:(0,i.k6)((()=>a[21]||(a[21]=[(0,i.Lk)("h3",null,"查看结果",-1),(0,i.Lk)("p",null,"获取详细分析报告并可下载PDF",-1)]))),_:1,__:[21]})])),_:1})])])}}},b=f,_=b,L={class:"login-container"},w={class:"login-form"},C={style:{margin:"16px"}},F={class:"agreement"},P={class:"popup-content"},E={class:"popup-content"};function A(e,a,l,t,n,s){const o=(0,i.g2)("van-nav-bar"),r=(0,i.g2)("van-field"),u=(0,i.g2)("van-button"),c=(0,i.g2)("van-cell-group"),d=(0,i.g2)("van-form"),h=(0,i.g2)("van-popup");return(0,i.uX)(),(0,i.CE)("div",L,[(0,i.bF)(o,{title:"登录/注册","left-text":"返回","left-arrow":"",onClickLeft:t.onClickLeft},null,8,["onClickLeft"]),(0,i.Lk)("div",w,[a[11]||(a[11]=(0,i.Lk)("h2",null,"欢迎使用八字命理AI人生指导",-1)),a[12]||(a[12]=(0,i.Lk)("p",null,"请使用手机号登录或注册",-1)),(0,i.bF)(d,{onSubmit:t.onSubmit},{default:(0,i.k6)((()=>[(0,i.bF)(c,{inset:""},{default:(0,i.k6)((()=>[(0,i.bF)(r,{modelValue:t.phone,"onUpdate:modelValue":a[0]||(a[0]=e=>t.phone=e),name:"phone",label:"手机号码",placeholder:"请输入手机号码",rules:[{required:!0,message:"请填写手机号码"}]},null,8,["modelValue"]),(0,i.bF)(r,{modelValue:t.verifyCode,"onUpdate:modelValue":a[1]||(a[1]=e=>t.verifyCode=e),center:"",clearable:"",label:"验证码",placeholder:"请输入验证码",rules:[{required:!0,message:"请填写验证码"}]},{button:(0,i.k6)((()=>[(0,i.bF)(u,{size:"small",type:"primary",disabled:t.isSending,onClick:t.sendVerifyCode},{default:(0,i.k6)((()=>[(0,i.eW)((0,v.v_)(t.sendButtonText),1)])),_:1},8,["disabled","onClick"])])),_:1},8,["modelValue"])])),_:1}),(0,i.Lk)("div",C,[(0,i.bF)(u,{round:"",block:"",type:"primary","native-type":"submit"},{default:(0,i.k6)((()=>a[8]||(a[8]=[(0,i.eW)(" 登录/注册 ")]))),_:1,__:[8]})])])),_:1},8,["onSubmit"]),(0,i.Lk)("div",F,[a[9]||(a[9]=(0,i.eW)(" 登录/注册即表示您同意 ")),(0,i.Lk)("span",{class:"link",onClick:a[2]||(a[2]=(...e)=>t.showAgreement&&t.showAgreement(...e))},"《用户协议》"),a[10]||(a[10]=(0,i.eW)(" 和 ")),(0,i.Lk)("span",{class:"link",onClick:a[3]||(a[3]=(...e)=>t.showPrivacy&&t.showPrivacy(...e))},"《隐私政策》")])]),(0,i.bF)(h,{show:t.showAgreementPopup,"onUpdate:show":a[5]||(a[5]=e=>t.showAgreementPopup=e),round:"",position:"bottom",style:{height:"70%"}},{default:(0,i.k6)((()=>[(0,i.Lk)("div",P,[a[14]||(a[14]=(0,i.Lk)("h3",null,"用户协议",-1)),a[15]||(a[15]=(0,i.Lk)("p",null,"这里是用户协议内容...",-1)),(0,i.bF)(u,{type:"primary",block:"",onClick:a[4]||(a[4]=e=>t.showAgreementPopup=!1)},{default:(0,i.k6)((()=>a[13]||(a[13]=[(0,i.eW)(" 我已阅读并同意 ")]))),_:1,__:[13]})])])),_:1},8,["show"]),(0,i.bF)(h,{show:t.showPrivacyPopup,"onUpdate:show":a[7]||(a[7]=e=>t.showPrivacyPopup=e),round:"",position:"bottom",style:{height:"70%"}},{default:(0,i.k6)((()=>[(0,i.Lk)("div",E,[a[17]||(a[17]=(0,i.Lk)("h3",null,"隐私政策",-1)),a[18]||(a[18]=(0,i.Lk)("p",null,"这里是隐私政策内容...",-1)),(0,i.bF)(u,{type:"primary",block:"",onClick:a[6]||(a[6]=e=>t.showPrivacyPopup=!1)},{default:(0,i.k6)((()=>a[16]||(a[16]=[(0,i.eW)(" 我已阅读并同意 ")]))),_:1,__:[16]})])])),_:1},8,["show"])])}const I={name:"LoginPage",setup(){const e=(0,n.rd)(),a=(0,o.KR)(""),l=(0,o.KR)(""),t=(0,o.KR)(!1),s=(0,o.KR)(0),i=(0,o.KR)("发送验证码"),r=(0,o.KR)(!1),u=(0,o.KR)(!1),c=()=>{e.go(-1)},d=()=>{s.value=60,t.value=!0;const e=setInterval((()=>{s.value--,i.value=`${s.value}秒后重发`,s.value<=0&&(clearInterval(e),t.value=!1,i.value="发送验证码")}),1e3)},v=()=>{a.value?/^1[3-9]\d{9}$/.test(a.value)?((0,y.y)("验证码已发送"),d()):(0,y.y)("请输入正确的手机号码"):(0,y.y)("请输入手机号码")},h=()=>{a.value?l.value?((0,y.y)("登录成功"),e.push("/user")):(0,y.y)("请输入验证码"):(0,y.y)("请输入手机号码")},p=()=>{r.value=!0},k=()=>{u.value=!0};return{phone:a,verifyCode:l,isSending:t,sendButtonText:i,showAgreementPopup:r,showPrivacyPopup:u,onClickLeft:c,sendVerifyCode:v,onSubmit:h,showAgreement:p,showPrivacy:k}}};var S=l(1241);const X=(0,S.A)(I,[["render",A],["__scopeId","data-v-583b5e2a"]]),z=X,D={class:"user-container"},$={class:"user-info"},T={class:"avatar"},W={class:"user-name"},x={key:0,class:"login-action"},R={key:1,class:"empty-history"};function K(e,a,l,t,n,s){const o=(0,i.g2)("van-nav-bar"),r=(0,i.g2)("van-image"),u=(0,i.g2)("van-button"),c=(0,i.g2)("van-cell"),d=(0,i.g2)("van-cell-group"),h=(0,i.g2)("van-empty");return(0,i.uX)(),(0,i.CE)("div",D,[(0,i.bF)(o,{title:"个人中心"}),(0,i.Lk)("div",$,[(0,i.Lk)("div",T,[(0,i.bF)(r,{round:"",width:"80",height:"80",src:"https://fastly.jsdelivr.net/npm/@vant/assets/cat.jpeg"})]),(0,i.Lk)("div",W,(0,v.v_)(t.userInfo.phone||"未登录"),1),t.isLoggedIn?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",x,[(0,i.bF)(u,{type:"primary",size:"small",onClick:t.goToLogin},{default:(0,i.k6)((()=>a[0]||(a[0]=[(0,i.eW)("登录/注册")]))),_:1,__:[0]},8,["onClick"])]))]),(0,i.bF)(d,{inset:"",title:"我的服务"},{default:(0,i.k6)((()=>[(0,i.bF)(c,{title:"历史查询记录","is-link":"",onClick:t.goToHistory},null,8,["onClick"]),(0,i.bF)(c,{title:"我的订单","is-link":"",onClick:t.goToOrders},null,8,["onClick"])])),_:1}),t.isLoggedIn&&t.historyList.length>0?((0,i.uX)(),(0,i.Wv)(d,{key:0,inset:"",title:"历史查询记录"},{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(t.historyList,(e=>((0,i.uX)(),(0,i.Wv)(c,{key:e.id,title:e.date,value:t.formatFocusAreas(e.focusAreas),"is-link":"",onClick:a=>t.viewResult(e.id)},null,8,["title","value","onClick"])))),128))])),_:1})):(0,i.Q3)("",!0),t.isLoggedIn&&0===t.historyList.length?((0,i.uX)(),(0,i.CE)("div",R,[(0,i.bF)(h,{description:"暂无查询记录"}),(0,i.bF)(u,{type:"primary",block:"",onClick:t.goToHome},{default:(0,i.k6)((()=>a[1]||(a[1]=[(0,i.eW)("立即测算")]))),_:1,__:[1]},8,["onClick"])])):(0,i.Q3)("",!0),t.isLoggedIn?((0,i.uX)(),(0,i.Wv)(d,{key:2,inset:"",title:"账号设置"},{default:(0,i.k6)((()=>[(0,i.bF)(c,{title:"退出登录",onClick:t.logout},null,8,["onClick"])])),_:1})):(0,i.Q3)("",!0)])}const Y={name:"UserPage",setup(){const e=(0,n.rd)(),a=(0,o.KR)({phone:"138****1234"}),l=(0,i.EW)((()=>!!a.value.phone)),t=(0,o.KR)([{id:"RES1649823456",date:"2025-04-10",focusAreas:["health","wealth","career"]},{id:"RES1649823789",date:"2025-03-25",focusAreas:["relationship","children"]}]),s=e=>{const a={health:"健康",wealth:"财运",career:"事业",relationship:"感情",children:"子女"};return e.map((e=>a[e]||e)).join("、")},r=()=>{e.push("/login")},u=()=>{e.push("/")},c=()=>{if(!l.value)return(0,y.y)("请先登录"),void r()},d=()=>{if(!l.value)return(0,y.y)("请先登录"),void r();(0,y.y)("订单功能开发中")},v=a=>{e.push(`/result/${a}`)},h=()=>{(0,y.y)("退出成功"),a.value={}};return{userInfo:a,isLoggedIn:l,historyList:t,formatFocusAreas:s,goToLogin:r,goToHome:u,goToHistory:c,goToOrders:d,viewResult:v,logout:h}}},j=(0,S.A)(Y,[["render",K],["__scopeId","data-v-ce9a05d4"]]),O=j,q={class:"payment-container"},V={class:"payment-method"},U={class:"payment-method"},B={class:"payment-action"},M={class:"qrcode-container"},Q={class:"qrcode"},N=["src"],H={key:1,class:"qrcode-placeholder"};function G(e,a,l,t,n,s){const o=(0,i.g2)("van-nav-bar"),r=(0,i.g2)("van-tag"),u=(0,i.g2)("van-card"),c=(0,i.g2)("van-cell"),d=(0,i.g2)("van-cell-group"),v=(0,i.g2)("van-icon"),h=(0,i.g2)("van-radio"),y=(0,i.g2)("van-button"),p=(0,i.g2)("van-popup");return(0,i.uX)(),(0,i.CE)("div",q,[(0,i.bF)(o,{title:"订单支付","left-text":"返回","left-arrow":"",onClickLeft:t.onClickLeft},null,8,["onClickLeft"]),(0,i.bF)(u,{title:"八字命理AI人生指导",desc:"个性化人生指导建议",price:"9.90",currency:"¥"},{tags:(0,i.k6)((()=>[(0,i.bF)(r,{plain:"",type:"primary"},{default:(0,i.k6)((()=>a[3]||(a[3]=[(0,i.eW)("专业分析")]))),_:1,__:[3]}),(0,i.bF)(r,{plain:"",type:"success"},{default:(0,i.k6)((()=>a[4]||(a[4]=[(0,i.eW)("AI解读")]))),_:1,__:[4]}),(0,i.bF)(r,{plain:"",type:"warning"},{default:(0,i.k6)((()=>a[5]||(a[5]=[(0,i.eW)("PDF报告")]))),_:1,__:[5]})])),_:1}),(0,i.bF)(d,{inset:"",title:"订单信息"},{default:(0,i.k6)((()=>[(0,i.bF)(c,{title:"订单编号",value:t.orderId},null,8,["value"]),(0,i.bF)(c,{title:"创建时间",value:t.createTime},null,8,["value"]),(0,i.bF)(c,{title:"支付金额",value:"¥9.90"})])),_:1}),(0,i.bF)(d,{inset:"",title:"选择支付方式"},{default:(0,i.k6)((()=>[(0,i.bF)(c,{clickable:"",onClick:a[0]||(a[0]=e=>t.paymentMethod="wechat")},{title:(0,i.k6)((()=>[(0,i.Lk)("div",V,[(0,i.bF)(v,{name:"wechat",color:"#07C160",size:"24"}),a[6]||(a[6]=(0,i.Lk)("span",{class:"payment-name"},"微信支付",-1))])])),"right-icon":(0,i.k6)((()=>[(0,i.bF)(h,{name:"wechat",checked:"wechat"===t.paymentMethod},null,8,["checked"])])),_:1}),(0,i.bF)(c,{clickable:"",onClick:a[1]||(a[1]=e=>t.paymentMethod="alipay")},{title:(0,i.k6)((()=>[(0,i.Lk)("div",U,[(0,i.bF)(v,{name:"alipay",color:"#1677FF",size:"24"}),a[7]||(a[7]=(0,i.Lk)("span",{class:"payment-name"},"支付宝",-1))])])),"right-icon":(0,i.k6)((()=>[(0,i.bF)(h,{name:"alipay",checked:"alipay"===t.paymentMethod},null,8,["checked"])])),_:1})])),_:1}),(0,i.Lk)("div",B,[(0,i.bF)(y,{round:"",block:"",type:"primary",onClick:t.onPayment},{default:(0,i.k6)((()=>a[8]||(a[8]=[(0,i.eW)(" 立即支付 ")]))),_:1,__:[8]},8,["onClick"])]),(0,i.bF)(p,{show:t.showQRCode,"onUpdate:show":a[2]||(a[2]=e=>t.showQRCode=e),round:""},{default:(0,i.k6)((()=>[(0,i.Lk)("div",M,[a[11]||(a[11]=(0,i.Lk)("h3",null,"请扫码支付",-1)),(0,i.Lk)("div",Q,[t.qrCodeUrl?((0,i.uX)(),(0,i.CE)("iframe",{key:0,src:t.qrCodeUrl,frameborder:"0",width:"200",height:"200"},null,8,N)):((0,i.uX)(),(0,i.CE)("div",H,a[9]||(a[9]=[(0,i.Lk)("p",null,"正在加载支付二维码...",-1)])))]),a[12]||(a[12]=(0,i.Lk)("p",null,"支付金额: ¥9.90",-1)),(0,i.bF)(y,{type:"primary",block:"",onClick:t.onPaymentSuccess},{default:(0,i.k6)((()=>a[10]||(a[10]=[(0,i.eW)(" 支付完成 ")]))),_:1,__:[10]},8,["onClick"])])])),_:1},8,["show"])])}var Z=l(788),J=l.n(Z);const ee={name:"PaymentPage",setup(){const e=(0,n.lq)(),a=(0,n.rd)(),l=e.query.gender,t=e.query.calendarType,s=e.query.birthDate,r=e.query.birthTime,u=e.query.birthPlace,c=e.query.livingPlace,d=e.query.focusAreas?.split(",")||[],v=(0,o.KR)("BZ1749371719072"),h=(0,o.KR)((new Date).toLocaleString()),p=(0,o.KR)("wechat"),k=(0,o.KR)(!1),g=(0,o.KR)(""),m=(0,o.KR)(!1);(0,i.sV)((()=>{console.log("订单创建成功",{gender:l,calendarType:t,birthDate:s,birthTime:r,birthPlace:u,livingPlace:c,focusAreas:d})}));const f=()=>{a.go(-1)},b=()=>{"wechat"===p.value?g.value="/images/wechat-qrcode.html":g.value="/images/alipay-qrcode.html",k.value=!0,console.log("发起支付请求",{orderId:v.value,paymentMethod:p.value}),console.log(`使用${p.value}支付，二维码URL:`,g.value)},_=async()=>{if(!m.value){m.value=!0,y.y.loading({message:"正在处理支付...",duration:0,forbidClick:!0});try{console.log("调用模拟支付API:",v.value);const e={birthDate:s,birthTime:r,gender:l,focusAreas:d},t=await J().post(`http://localhost:5000/api/order/mock/pay/${v.value}`,e,{headers:{"Content-Type":"application/json"}});if(console.log("模拟支付API响应:",t.data),200===t.data.code){y.y.success("支付成功"),k.value=!1;const e=t.data.data.resultId;if(!e)return console.error("服务器未返回有效的resultId"),void y.y.fail("获取结果ID失败，请联系客服");console.log("获取到结果ID:",e),a.push({path:`/result/${e}`,query:{birthDate:s,birthTime:r,gender:l,birthPlace:u,livingPlace:c,originalOrderId:v.value}})}else y.y.fail(t.data.message||"支付处理失败")}catch(e){console.error("支付处理出错:",e),y.y.clear(),y.y.fail("支付处理出错，将使用默认结果ID");const t="RES"+v.value.replace(/^BZ/,"");console.log("使用默认结果ID:",t),a.push({path:`/result/${t}`,query:{birthDate:s,birthTime:r,gender:l,birthPlace:u,livingPlace:c,originalOrderId:v.value}})}finally{m.value=!1}}};return{orderId:v,createTime:h,paymentMethod:p,showQRCode:k,qrCodeUrl:g,isProcessing:m,onClickLeft:f,onPayment:b,onPaymentSuccess:_}}},ae=(0,S.A)(ee,[["render",G],["__scopeId","data-v-34da18f8"]]),le=ae;var te=l(1445),ne=l(1749),se=l(2125),ie=l.n(se);const oe={class:"result-container"},re={class:"analysis-progress"},ue={class:"bazi-chart"},ce={key:0,class:"four-pillars"},de={class:"pillar"},ve={class:"stem"},he={class:"branch"},ye={class:"nayin"},pe={class:"shishen"},ke={class:"wangshuai"},ge={class:"pillar"},me={class:"stem"},fe={class:"branch"},be={class:"nayin"},_e={class:"shishen"},Le={class:"wangshuai"},we={class:"pillar"},Ce={class:"stem"},Fe={class:"branch"},Pe={class:"nayin"},Ee={class:"shishen"},Ae={class:"wangshuai"},Ie={class:"pillar"},Se={class:"stem"},Xe={class:"branch"},ze={class:"nayin"},De={class:"shishen"},$e={class:"wangshuai"},Te={key:1,class:"error-message"},We={key:2,class:"five-elements"},xe={class:"element-name"},Re={class:"element-value"},Ke={key:3,class:"five-elements"},Ye={class:"element-name"},je={key:4,class:"shen-sha-info"},Oe={class:"shen-sha-content"},qe={class:"shen-sha-item"},Ve={class:"value"},Ue={class:"shen-sha-item"},Be={class:"value"},Me={class:"shen-sha-item"},Qe={class:"value"},Ne={class:"shen-sha-item"},He={class:"value"},Ge={class:"shen-sha-item"},Ze={class:"value"},Je={key:0,class:"ben-ming-sha"},ea={class:"ben-ming-list"},aa={key:5,class:"shen-sha-info"},la={key:6,class:"da-yun-info"},ta={class:"qi-yun-info"},na={class:"da-yun-table"},sa={class:"custom-table"},ia={key:7,class:"da-yun-info"},oa={key:8,class:"liu-nian-info"},ra={class:"custom-table"},ua={key:9,class:"liu-nian-info"},ca={class:"ai-analysis"},da={key:0,class:"age-notice"},va={key:1,class:"age-notice"},ha={key:2,class:"age-notice"},ya={class:"analysis-progress"},pa={class:"analysis-section"},ka={key:0,class:"loading-content"},ga={key:1},ma={class:"analysis-section"},fa={key:0,class:"loading-content"},ba={key:1},_a={class:"analysis-section"},La={key:0,class:"loading-content"},wa={key:1},Ca={class:"analysis-section"},Fa={key:0,class:"loading-content"},Pa={key:1},Ea={class:"analysis-section"},Aa={key:0,class:"loading-content"},Ia={key:1},Sa={key:0,class:"enhanced-analysis"},Xa={class:"analysis-source"},za={key:1},Da={class:"analysis-section"},$a={key:0,class:"loading-content"},Ta={key:1},Wa={key:0,class:"enhanced-analysis"},xa={class:"analysis-source"},Ra={key:1},Ka={class:"analysis-section"},Ya={key:0,class:"loading-content"},ja={key:1},Oa={key:0,class:"enhanced-analysis"},qa={class:"analysis-source"},Va={key:1},Ua={class:"analysis-section"},Ba={key:0,class:"loading-content"},Ma={key:1},Qa={key:0,class:"enhanced-analysis"},Na={class:"analysis-source"},Ha={key:1},Ga={class:"analysis-section"},Za={key:0,class:"loading-content"},Ja={key:1},el={key:0,class:"enhanced-analysis"},al={class:"analysis-source"},ll={key:1},tl={class:"analysis-section"},nl={key:0,class:"loading-content"},sl={key:1},il={key:0,class:"enhanced-analysis"},ol={class:"analysis-source"},rl={key:1},ul={class:"analysis-section"},cl={key:0,class:"loading-content"},dl={key:1},vl={key:0,class:"enhanced-analysis"},hl={class:"analysis-source"},yl={key:1},pl={class:"analysis-section"},kl={key:0,class:"loading-content"},gl={key:1},ml={key:0,class:"enhanced-analysis"},fl={class:"analysis-source"},bl={key:1},_l={class:"action-buttons"},Ll={key:1,class:"followup-section"},wl={class:"followup-options"},Cl=["onClick"],Fl={class:"option-content"},Pl={class:"option-name"},El={key:0,class:"option-status"},Al={key:1,class:"option-status"},Il={key:0,class:"followup-result"},Sl={key:0,class:"loading-content"},Xl={key:1,class:"loading-content"},zl={key:2,class:"analysis-content"},Dl={class:"followup-dialog-content"},$l={__name:"Result",setup(e){const a=(0,n.lq)(),l=(0,n.rd)(),t=(0,o.KR)(a.params.id||a.query.resultId),s=(0,o.KR)(0),r=(0,o.KR)(!1),u=(0,o.KR)(!1),c=(0,o.KR)(0),d=(0,o.KR)(null),h=(0,o.KR)(null);a.query.age&&!isNaN(parseInt(a.query.age))?h.value=parseInt(a.query.age):localStorage.getItem("userAge")&&!isNaN(parseInt(localStorage.getItem("userAge")))&&(h.value=parseInt(localStorage.getItem("userAge"))),console.log("用户年龄:",h.value);(0,o.KR)([]),(0,o.KR)({});const p=(0,o.KR)({yearPillar:{heavenlyStem:"",earthlyBranch:"",naYin:"",shiShen:"",wangShuai:""},monthPillar:{heavenlyStem:"",earthlyBranch:"",naYin:"",shiShen:"",wangShuai:""},dayPillar:{heavenlyStem:"",earthlyBranch:"",naYin:"",shiShen:"",wangShuai:""},hourPillar:{heavenlyStem:"",earthlyBranch:"",naYin:"",shiShen:"",wangShuai:""},fiveElements:{},flowingYears:[],shenSha:{dayChong:"",zhiShen:"",xiShen:"",fuShen:"",caiShen:"",benMing:[],yearGan:[],yearZhi:[],dayGan:[],dayZhi:[]},daYun:{startAge:0,startYear:0,isForward:!0,daYunList:[]},birthDate:null,birthTime:null,gender:null}),k=(0,o.KR)({health:"",career:"",relationship:"",children:"",social:"",future:"",parents:"",education:"",coreAnalysis:"",fiveElements:"",shenShaAnalysis:"",keyPoints:""}),g=async()=>{try{y.y.loading("正在测试API连接...");const e=await J().get("/");return console.log("API根路径响应:",e.data),y.y.success("API连接成功"),!0}catch(e){return console.error("API连接测试失败:",e),y.y.fail("API连接失败，请检查后端服务"),!1}};(0,i.sV)((async()=>{const e=await g();if(!e)return console.warn("API连接失败，将使用模拟数据"),void(r.value=!1);console.log("结果页面加载，URL参数中的ID:",t.value);const l=localStorage.getItem("resultId");if(!t.value&&l&&(console.log("从本地存储获取ID:",l),t.value=l),!0!==t.value&&!1!==t.value||(console.error("resultId不应该是布尔值:",t.value),t.value=l||a.query.resultId||""),console.log("最终使用的resultId:",t.value),!t.value){console.error("缺少结果ID，无法获取分析结果");const e=a.query.resultId;if(!e)return y.y.fail("缺少结果ID，无法获取分析结果"),void(r.value=!1);console.log("从URL查询参数获取备选ID:",e),t.value=e}localStorage.setItem("resultId",t.value),y.y.loading({message:"正在加载八字分析结果，请稍候...",duration:0,forbidClick:!0}),await W();const n=Object.values(k.value).some((e=>"string"===typeof e&&e.includes("正在分析")));n&&(console.log("检测到分析仍在进行中..."),y.y.loading({message:"正在生成八字分析结果，这可能需要30-60秒...",duration:0}),await P(t.value),y.y.success("分析完成")),y.y.clear()}));const m=e=>{if(!e)return"--";const a={wood:"木",fire:"火",earth:"土",metal:"金",water:"水",木:"木",火:"火",土:"土",金:"金",水:"水"};return a[e]||e},f=()=>{l.push("/")},b=async()=>{if(y.y.loading({message:"正在生成PDF并下载报告...",duration:0,position:"middle",forbidClick:!0}),!t.value)return y.y.clear(),y.y.fail("缺少结果ID，无法下载报告"),!1;try{console.log("直接下载报告, 结果ID:",t.value);const l=(new Date).getTime(),n=`/api/bazi/pdf/${t.value}?t=${l}`;console.log("下载URL:",n);const s=await fetch(n,{method:"GET",cache:"no-cache",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}});if(!s.ok){let a=`下载失败: HTTP错误 ${s.status}`;try{const e=s.headers.get("content-type");if(e&&e.includes("application/json")){const e=await s.json();a=e.message||a}else{const e=await s.text();e&&(a=`下载失败: ${e.substring(0,100)}`)}}catch(e){console.error("解析错误响应失败:",e)}throw new Error(a)}const i=s.headers.get("content-type"),o=s.headers.get("content-disposition");console.log("响应内容类型:",i),console.log("响应内容处置:",o);let r=`八字命理分析_${t.value}.pdf`;if(o&&o.includes("filename=")){const e=o.match(/filename=["']?([^"']+)["']?/);e&&e[1]&&(r=e[1])}const u=i&&i.includes("html")?"html":"pdf";r.endsWith(u)||(r=`八字命理分析_${t.value}.${u}`);const c=await s.blob();console.log("PDF Blob大小:",c.size,"字节");const d=o&&o.includes("attachment");if(0===c.size&&!d)throw new Error("下载的文件为空");if(c.size>0&&c.size<1048576&&i&&i.includes("pdf"))try{const e=new FileReader,a=new Promise(((a,l)=>{e.onloadend=e=>a(e.target.result),e.onerror=e=>l(e)}));e.readAsArrayBuffer(c.slice(0,5));const l=await a,t=new Uint8Array(l),n=String.fromCharCode.apply(null,t);if(!n.startsWith("%PDF"))throw console.error("无效的PDF文件头:",n),new Error("下载的不是有效的PDF文件");console.log("PDF文件头验证通过")}catch(e){if(console.error("验证PDF文件失败:",e),!d)throw new Error("验证PDF文件失败: "+e.message);console.warn("浏览器接管了下载，跳过PDF验证")}try{const e=window.URL.createObjectURL(c);console.log("创建Blob URL:",e);const a=document.createElement("iframe");a.style.display="none",document.body.appendChild(a);const l=document.createElement("a");l.href=e,l.download=`八字命理分析_${t.value}.pdf`,l.target="_blank",l.rel="noopener noreferrer",a.contentWindow.document.body.appendChild(l),console.log("触发下载, 文件名:",l.download),l.click(),setTimeout((()=>{window.URL.revokeObjectURL(e),document.body.removeChild(a),console.log("清理下载资源完成")}),1e3)}catch(e){console.error("创建下载链接失败:",e);try{console.log("尝试使用window.open方法下载");const e=window.open(n,"_blank");e||(console.warn("弹出窗口被阻止，尝试其他方法"),te.l.alert({title:"下载提示",message:"系统无法自动下载PDF，请点击确定后手动保存文件",confirmButtonText:"确定"}).then((()=>{window.open(n,"_blank")})))}catch(a){throw console.error("使用window.open下载失败:",a),new Error("下载失败，请尝试使用其他浏览器")}}return y.y.clear(),y.y.success("报告下载成功"),!0}catch(l){return console.error("直接下载PDF出错:",l),y.y.clear(),l.message&&(l.message.includes("下载的文件为空")||l.message.includes("验证PDF文件失败"))?(console.log("可能是浏览器已经接管了下载，不显示错误"),y.y.success("报告下载已开始，请等待浏览器完成下载"),!0):(y.y.fail(l.message||"下载失败，请稍后重试"),!1)}},_=async()=>{if(y.y.loading({message:"正在生成并下载PDF报告...",duration:5e3,position:"middle"}),!t.value)return void y.y.fail("缺少结果ID，无法生成报告");let e=0,a=!1;while(e<3&&!a)if(e++,e>1&&(console.log(`尝试第${e}次下载...`),y.y.loading({message:`尝试第${e}次下载...`,duration:2e3}),await new Promise((e=>setTimeout(e,2e3)))),a=await b(),!0===a)return;a||(y.y.clear(),te.l.alert({title:"PDF下载失败",message:"下载PDF报告失败，请稍后再试。如果问题持续存在，请联系客服。"}))},L=async()=>{console.log("使用客户端jsPDF库生成PDF");const e=document.querySelector(".result-container");if(!e)throw new Error("找不到要转换的内容元素");y.y.loading({message:"正在捕获页面内容...",duration:5e3});try{const a=await ie()(e,{scale:1,useCORS:!0,logging:!1,windowWidth:document.documentElement.offsetWidth,windowHeight:document.documentElement.offsetHeight});y.y.loading({message:"正在生成PDF文件...",duration:5e3});const l=new ne.uE("p","mm","a4"),n=a.toDataURL("image/png"),s=210,i=297,o=a.height*s/a.width;let r=o,u=0;l.addImage(n,"PNG",0,u,s,o),r-=i;while(r>0)u=r-o,l.addPage(),l.addImage(n,"PNG",0,u,s,o),r-=i;const c=l.internal.getNumberOfPages();for(let e=1;e<=c;e++)l.setPage(e),l.setFontSize(10),l.setTextColor(150),l.text(`八字命理AI分析报告 - 页 ${e} / ${c}`,l.internal.pageSize.getWidth()/2,l.internal.pageSize.getHeight()-10,{align:"center"});return l.save(`八字命理分析_${t.value}.pdf`),!0}catch(a){throw console.error("本地PDF生成错误:",a),a}},w=()=>{y.y.success("分享功能开发中")},C=async()=>{try{y.y.loading({message:"正在本地生成PDF...",duration:0,forbidClick:!0}),await L(),y.y.clear(),y.y.success("本地PDF生成成功")}catch(e){console.error("本地PDF生成失败:",e),y.y.clear(),y.y.fail("本地PDF生成失败: "+(e.message||"未知错误"))}},F=async e=>{try{console.log("检查分析状态:",e);const a=await J().get(`/api/bazi/result/${e}`);if(200===a.data.code){const e=a.data.data.aiAnalysis||{};let l=0,t=0;Object.entries(e).forEach((([e,a])=>{l++,"string"===typeof a&&a.includes("正在分析")||t++})),l>0&&(c.value=Math.floor(t/l*100));const n=Object.values(e).some((e=>"string"===typeof e&&e.includes("正在分析")));return u.value=n,n?(console.log("分析仍在进行中...",`完成度: ${c.value}%`),!1):(console.log("分析已完成"),!0)}return!1}catch(a){return console.error("检查分析状态出错:",a),!1}},P=async(e,a=30)=>{let l=0;return u.value=!0,d.value&&clearInterval(d.value),d.value=setInterval((()=>{c.value<90&&(c.value+=2)}),2e3),new Promise((t=>{const n=setInterval((async()=>{l++;const s=await F(e);(s||l>=a)&&(clearInterval(n),d.value&&(clearInterval(d.value),d.value=null),s&&(c.value=100,setTimeout((()=>{u.value=!1}),1e3)),await W(),y.y.clear(),t(s))}),2e3)}))},E=async()=>{y.y.loading("正在重新加载数据...");try{if(!t.value)return void y.y.fail("缺少结果ID");console.log(`重新加载数据，结果ID: ${t.value}`);const l=new URLSearchParams(window.location.search);try{console.log("尝试使用模拟支付接口..."),y.y.loading({message:"正在处理支付...",duration:0,position:"middle",forbidClick:!0});const e={birthDate:p.value.birthDate||l.get("birthDate"),birthTime:p.value.birthTime||l.get("birthTime"),gender:p.value.gender||l.get("gender")};console.log("请求数据:",e);const a=await J().post(`/api/order/mock/pay/${t.value}`,e);if(console.log("模拟支付响应:",a.data),200===a.data.code&&(y.y.success("支付成功"),a.data.data&&a.data.data.resultId)){const e=a.data.data.resultId;console.log("获取到新的resultId:",e),t.value=e,localStorage.setItem("resultId",e),y.y.loading({message:"正在生成八字分析结果，这可能需要30-60秒...",duration:0,position:"middle",forbidClick:!0});const l=await P(e);return l?y.y.success("分析已完成"):y.y.success("已完成部分分析，显示可用结果"),void await R()}}catch(e){return console.error("模拟支付失败:",e),void y.y.fail("重新加载失败: "+(e.message||"未知错误"))}try{y.y.loading({message:"正在加载现有分析结果...",duration:0,forbidClick:!0});const e=await J().get(`/api/bazi/result/${t.value}`);if(200===e.data.code){p.value={yearPillar:e.data.data.baziChart?.yearPillar||null,monthPillar:e.data.data.baziChart?.monthPillar||null,dayPillar:e.data.data.baziChart?.dayPillar||null,hourPillar:e.data.data.baziChart?.hourPillar||null,fiveElements:e.data.data.baziChart?.fiveElements||null,flowingYears:e.data.data.baziChart?.flowingYears||[],shenSha:e.data.data.baziChart?.shenSha||p.value.shenSha,daYun:e.data.data.baziChart?.daYun||p.value.daYun,birthDate:e.data.data.baziChart?.birthDate||null,birthTime:e.data.data.baziChart?.birthTime||null,gender:e.data.data.baziChart?.gender||null},k.value={health:e.data.data.aiAnalysis?.health||"",career:e.data.data.aiAnalysis?.career||"",relationship:e.data.data.aiAnalysis?.relationship||"",children:e.data.data.aiAnalysis?.children||"",social:e.data.data.aiAnalysis?.social||"",future:e.data.data.aiAnalysis?.future||"",parents:e.data.data.aiAnalysis?.parents||"",education:e.data.data.aiAnalysis?.education||"",coreAnalysis:e.data.data.aiAnalysis?.coreAnalysis||"",fiveElements:e.data.data.aiAnalysis?.fiveElements||"",shenShaAnalysis:e.data.data.aiAnalysis?.shenShaAnalysis||"",keyPoints:e.data.data.aiAnalysis?.keyPoints||""};const a=Object.values(k.value).some((e=>"string"===typeof e&&e.includes("正在分析")));u.value=a,a?console.log("分析仍在进行中..."):(c.value=100,setTimeout((()=>{u.value=!1}),1e3)),console.log("重新加载追问分析结果..."),await R();const l=A.value.filter((e=>e.paid));if(l.length>0){console.log("发现已支付的追问选项，强制重新获取:",l.map((e=>e.id)));for(const e of l)await T(e.id)}y.y.success("数据刷新成功")}else y.y.fail(e.data.message||"加载失败")}catch(a){console.error("重新加载失败:",a),y.y.fail("加载失败: "+(a.message||"未知错误"))}}catch(a){console.error("重新加载失败:",a),y.y.fail("加载失败: "+(a.message||"未知错误"))}},A=(0,o.KR)([{id:"marriage",name:"婚姻感情",selected:!1,paid:!1},{id:"career",name:"事业财运",selected:!1,paid:!1},{id:"children",name:"子女情况",selected:!1,paid:!1},{id:"parents",name:"父母情况",selected:!1,paid:!1},{id:"health",name:"身体健康",selected:!1,paid:!1},{id:"education",name:"学业",selected:!1,paid:!1},{id:"relationship",name:"人际关系",selected:!1,paid:!1},{id:"fiveYears",name:"近五年运势",selected:!1,paid:!1}]),I=(0,o.KR)(null),S=(0,o.KR)(!1),X=(0,o.KR)({}),z=(0,o.KR)(!1),D=async e=>{if(I.value=e,e.paid){if(console.log(`选择已支付的追问: ${e.id}`),X.value[e.id])return void console.log(`已有${e.id}分析结果，直接显示`);console.log(`尝试获取${e.id}分析结果`),y.y.loading({message:"正在加载分析结果...",duration:0});try{const a=await T(e.id);a&&"string"===typeof a&&a.length>0?(y.y.success("加载成功"),console.log(`成功获取${e.id}分析结果，长度: ${a.length}`)):(y.y.fail("分析结果尚未生成完成，请稍后再试"),console.warn(`获取${e.id}分析结果失败或为空`))}catch(a){console.error(`获取${e.id}分析失败:`,a),y.y.fail("获取分析失败，请重试")}finally{y.y.clear()}}else S.value=!0},$=async()=>{if(I.value)try{z.value=!0,y.y.loading({message:"正在创建订单...",forbidClick:!0,duration:0});const e=new URLSearchParams(window.location.search),a=await J().post("/api/order/create/followup",{resultId:t.value,area:I.value.id});if(200===a.data.code){const l=a.data.data.orderId;console.log("追问订单创建成功:",l),y.y.loading({message:"正在处理支付...",forbidClick:!0,duration:0});const n=await J().post(`/api/order/mock/pay/${l}`,{birthDate:p.value?.birthDate||e.get("birthDate"),birthTime:p.value?.birthTime||e.get("birthTime"),gender:p.value?.gender||e.get("gender"),area:I.value.id,resultId:t.value});if(200===n.data.code){console.log("追问支付成功:",n.data),y.y.success("支付成功");const e=A.value.findIndex((e=>e.id===I.value.id));if(-1!==e&&(A.value[e].paid=!0,A.value=[...A.value]),y.y.loading({message:"正在生成分析结果，这可能需要30-60秒...",forbidClick:!0,duration:0}),n.data.data&&n.data.data.resultId){const e=n.data.data.resultId;console.log("获取到新的resultId:",e),t.value=e,localStorage.setItem("resultId",e)}const a=I.value.id;let l=!1,i=0;const o=60,r=async()=>{console.log(`开始轮询追问分析状态: ${a}`);const e=(new Date).getTime(),n=12e4;while(i<o&&!l){i++;try{await new Promise((e=>setTimeout(e,2e3)));const s=(new Date).getTime();if(s-e>n){console.warn(`轮询追问分析状态超时: ${a}`);break}console.log(`尝试第${i}次获取追问分析: ${a}`);const o=await J().get(`/api/bazi/followup/${t.value}/${a}`);if(200===o.data.code&&o.data.data&&o.data.data.analysis){const e=o.data.data.analysis;if("string"===typeof e&&!e.includes("正在分析")){console.log(`成功获取追问分析结果: ${a}`),l=!0,X.value[a]=e;break}console.log(`追问分析结果还在生成中: ${a}`)}}catch(s){s.response&&404===s.response.status||console.error("检查追问分析状态出错:",s),s.response&&404===s.response.status?console.log("追问分析尚未创建完毕，继续等待..."):i>=o/2&&console.warn(`获取分析数据失败(${i}/${o})，继续尝试...`)}}console.log(`轮询完成，最终尝试获取追问分析: ${a}`);try{const e=await T(a);return console.log("最终获取追问分析结果: "+(e?"成功":"失败")),e}catch(s){return console.error("获取最终追问分析结果失败:",s),X.value[a]="分析正在处理中，请稍后刷新页面查看。",null}},u=await r();y.y.clear(),u?(y.y.success("分析已完成"),s.value=1,setTimeout((()=>{const e={relationship:"婚姻感情",marriage:"婚姻感情",career:"事业财运",work:"事业财运",money:"事业财运",wealth:"事业财运",children:"子女情况",family:"子女情况",parents:"父母情况",health:"身体健康",education:"学业",study:"学业",social:"人际关系",friends:"人际关系",future:"近五年运势",fiveYears:"近五年运势"},a=e[I.value.id];if(a){const e=document.querySelectorAll(".analysis-section h3");for(let l=0;l<e.length;l++)if(e[l].textContent.includes(a)){e[l].scrollIntoView({behavior:"smooth",block:"center"});const a=e[l].parentElement;a.classList.add("highlight-section"),setTimeout((()=>{a.classList.remove("highlight-section")}),3e3);break}}}),500)):y.y.success("正在生成分析，请稍后刷新查看"),S.value=!1,setTimeout((()=>{const e=A.value.findIndex((e=>e.id===I.value.id));-1!==e&&(A.value=[...A.value])}),500)}else y.y.fail("支付失败")}else y.y.fail("创建订单失败")}catch(e){console.error("追问支付过程出错:",e),y.y.fail("处理失败，请重试")}finally{z.value=!1,y.y.clear()}},T=async e=>{r.value=!0;try{console.log(`开始获取[${e}]追问分析，结果ID: ${t.value}`);const a=await J().get(`/api/bazi/followup/${t.value}/${e}`);if(200===a.data.code){if(console.log("获取追问分析成功，响应数据:",a.data),console.log("响应data字段详情:",JSON.stringify(a.data.data)),!a.data.data){console.warn(`追问分析结果data为空: ${e}`);const a=`${A.value.find((a=>a.id===e))?.name||e}分析正在生成中，请稍后刷新页面查看。`;return X.value[e]=a,a}let l=null;if(a.data.data.analysis)l=a.data.data.analysis,console.log(`获取到标准格式分析结果, 类型: ${typeof l}, 长度: ${l?l.length:0}`);else if("string"===typeof a.data.data)l=a.data.data,console.log(`获取到字符串格式分析结果, 长度: ${l.length}`);else if(a.data.data[e])l=a.data.data[e],console.log(`获取到对象格式分析结果, 长度: ${l?l.length:0}`);else{console.log("尝试查找匹配内容，data的所有键:",Object.keys(a.data.data));for(const t in a.data.data)if(t.toLowerCase()===e.toLowerCase()||"fiveYears"===e&&"future"===t||"future"===e&&"fiveYears"===t){l=a.data.data[t],console.log(`找到匹配的键[${t}]，内容长度: ${l?l.length:0}`);break}}if(!l){console.warn(`无法从响应中提取有效分析内容: ${e}`);const a=`${A.value.find((a=>a.id===e))?.name||e}分析尚未生成，请稍后刷新页面查看。`;return X.value[e]=a,a}if("string"===typeof l&&""===l.trim()){console.warn(`追问分析结果为空字符串: ${e}`);const a=`${A.value.find((a=>a.id===e))?.name||e}分析正在生成中，请稍后刷新页面查看。`;return X.value[e]=a,a}return console.log(`获取到有效的[${e}]分析结果，长度: ${l.length}`),X.value[e]=l,l}{console.error("获取追问分析失败:",a.data);const l=`获取分析失败: ${a.data.message||"未知错误"}`;return X.value[e]=l,l}}catch(a){console.error("获取追问分析出错:",a);const l=`获取分析出错: ${a.message||"请稍后重试"}`;return X.value[e]=l,l}finally{r.value=!1}},W=async()=>{r.value=!0;try{console.log("获取八字分析结果，ID:",t.value);const e=await J().get(`/api/bazi/result/${t.value}`);console.log("八字分析结果:",e.data),200===e.data.code&&e.data.data?(e.data.data.baziChart?p.value={yearPillar:e.data.data.baziChart.yearPillar||p.value.yearPillar,monthPillar:e.data.data.baziChart.monthPillar||p.value.monthPillar,dayPillar:e.data.data.baziChart.dayPillar||p.value.dayPillar,hourPillar:e.data.data.baziChart.hourPillar||p.value.hourPillar,fiveElements:e.data.data.baziChart.fiveElements||p.value.fiveElements,flowingYears:e.data.data.baziChart.flowingYears||[],shenSha:e.data.data.baziChart.shenSha||p.value.shenSha,daYun:e.data.data.baziChart.daYun||p.value.daYun,birthDate:e.data.data.baziChart.birthDate||null,birthTime:e.data.data.baziChart.birthTime||null,gender:e.data.data.baziChart.gender||null}:(console.warn("响应中缺少baziChart数据"),y.y.fail("数据格式不正确")),e.data.data.aiAnalysis&&(k.value={health:e.data.data.aiAnalysis.health||"",career:e.data.data.aiAnalysis.career||"",relationship:e.data.data.aiAnalysis.relationship||"",children:e.data.data.aiAnalysis.children||"",social:e.data.data.aiAnalysis.social||"",future:e.data.data.aiAnalysis.future||"",parents:e.data.data.aiAnalysis.parents||"",education:e.data.data.aiAnalysis.education||"",coreAnalysis:e.data.data.aiAnalysis.coreAnalysis||"",fiveElements:e.data.data.aiAnalysis.fiveElements||"",shenShaAnalysis:e.data.data.aiAnalysis.shenShaAnalysis||"",keyPoints:e.data.data.aiAnalysis.keyPoints||""}),x(),await R(),y.y.success("分析结果加载成功")):(console.error("获取八字分析结果失败:",e.data.message),y.y.fail(e.data.message||"获取分析结果失败"))}catch(e){console.error("获取八字分析结果出错:",e),y.y.fail("获取分析结果失败，请稍后再试")}finally{r.value=!1}},x=()=>{null!==h.value&&(h.value<6?A.value=A.value.filter((e=>["health","personality","education","parents"].includes(e.id))):h.value<18&&(A.value=A.value.filter((e=>!["marriage","career"].includes(e.id))))),console.log("初始化追问选项完成:",A.value)},R=async()=>{try{if(!t.value)return void console.warn("缺少结果ID，无法加载追问分析");console.log("开始加载追问分析结果列表:",t.value);const e=await J().get(`/api/bazi/followup/list/${t.value}`);if(200===e.data.code&&e.data.data.followups){const a=e.data.data.followups;console.log("获取到的追问列表:",a),A.value=A.value.map((e=>{const l=a.some((a=>"object"===typeof a?a.area===e.id:"string"===typeof a&&a===e.id));return l&&(console.log(`发现已支付的追问: ${e.id}`),T(e.id)),{...e,paid:l}})),console.log("更新后的追问选项:",A.value)}else console.warn("获取追问列表失败或返回空列表")}catch(e){console.error("加载追问分析结果出错:",e)}};(0,i.hi)((()=>{d.value&&(clearInterval(d.value),d.value=null)}));const K=async e=>{if(e)try{z.value=!0,y.y.loading({message:"正在刷新分析结果...",duration:0}),console.log(`刷新${e}分析结果`);const a=await T(e);a&&"string"===typeof a&&a.length>0?(y.y.success("刷新成功"),console.log(`成功刷新${e}分析结果，长度: ${a.length}`)):(y.y.fail("分析结果尚未生成完成"),console.warn(`刷新${e}分析结果失败或为空`))}catch(a){console.error(`刷新${e}分析失败:`,a),y.y.fail("刷新失败，请重试")}finally{z.value=!1,y.y.clear()}};return(e,a)=>{const l=(0,i.g2)("van-nav-bar"),t=(0,i.g2)("van-progress"),n=(0,i.g2)("van-notice-bar"),o=(0,i.g2)("van-empty"),d=(0,i.g2)("van-button"),y=(0,i.g2)("van-cell"),g=(0,i.g2)("van-cell-group"),b=(0,i.g2)("van-tab"),L=(0,i.g2)("van-loading"),F=(0,i.g2)("van-tag"),P=(0,i.g2)("van-tabs"),T=(0,i.g2)("van-dialog");return(0,i.uX)(),(0,i.CE)("div",oe,[(0,i.bF)(l,{title:"八字分析结果","left-text":"返回","left-arrow":"",onClickLeft:f}),a[63]||(a[63]=(0,i.Lk)("div",{class:"result-header"},[(0,i.Lk)("h2",null,"您的八字命盘分析"),(0,i.Lk)("p",null,"基于您的出生信息，AI为您提供的个性化人生指导")],-1)),u.value?((0,i.uX)(),(0,i.Wv)(n,{key:0,color:"#1989fa",background:"#ecf9ff","left-icon":"info-o",scrollable:!1,class:"analysis-progress-notice"},{default:(0,i.k6)((()=>[(0,i.Lk)("div",re,[a[3]||(a[3]=(0,i.Lk)("p",null,"AI正在生成八字分析结果，这可能需要30-60秒",-1)),(0,i.bF)(t,{percentage:c.value,"show-pivot":!1,color:"#1989fa"},null,8,["percentage"])])])),_:1})):(0,i.Q3)("",!0),(0,i.bF)(P,{modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=e=>s.value=e),sticky:""},{default:(0,i.k6)((()=>[(0,i.bF)(b,{title:"命盘信息"},{default:(0,i.k6)((()=>[(0,i.Lk)("div",ue,[a[18]||(a[18]=(0,i.Lk)("h3",null,"八字命盘",-1)),p.value&&p.value.yearPillar&&p.value.monthPillar&&p.value.dayPillar&&p.value.hourPillar?((0,i.uX)(),(0,i.CE)("div",ce,[(0,i.Lk)("div",de,[(0,i.Lk)("div",ve,(0,v.v_)(p.value.yearPillar.heavenlyStem),1),(0,i.Lk)("div",he,(0,v.v_)(p.value.yearPillar.earthlyBranch),1),a[4]||(a[4]=(0,i.Lk)("div",{class:"label"},"年柱",-1)),(0,i.Lk)("div",ye,(0,v.v_)(p.value.yearPillar.naYin),1),(0,i.Lk)("div",pe,(0,v.v_)(p.value.yearPillar.shiShen),1),(0,i.Lk)("div",ke,(0,v.v_)(p.value.yearPillar.wangShuai),1)]),(0,i.Lk)("div",ge,[(0,i.Lk)("div",me,(0,v.v_)(p.value.monthPillar.heavenlyStem),1),(0,i.Lk)("div",fe,(0,v.v_)(p.value.monthPillar.earthlyBranch),1),a[5]||(a[5]=(0,i.Lk)("div",{class:"label"},"月柱",-1)),(0,i.Lk)("div",be,(0,v.v_)(p.value.monthPillar.naYin),1),(0,i.Lk)("div",_e,(0,v.v_)(p.value.monthPillar.shiShen),1),(0,i.Lk)("div",Le,(0,v.v_)(p.value.monthPillar.wangShuai),1)]),(0,i.Lk)("div",we,[(0,i.Lk)("div",Ce,(0,v.v_)(p.value.dayPillar.heavenlyStem),1),(0,i.Lk)("div",Fe,(0,v.v_)(p.value.dayPillar.earthlyBranch),1),a[6]||(a[6]=(0,i.Lk)("div",{class:"label"},"日柱",-1)),(0,i.Lk)("div",Pe,(0,v.v_)(p.value.dayPillar.naYin),1),(0,i.Lk)("div",Ee,(0,v.v_)(p.value.dayPillar.shiShen),1),(0,i.Lk)("div",Ae,(0,v.v_)(p.value.dayPillar.wangShuai),1)]),(0,i.Lk)("div",Ie,[(0,i.Lk)("div",Se,(0,v.v_)(p.value.hourPillar.heavenlyStem),1),(0,i.Lk)("div",Xe,(0,v.v_)(p.value.hourPillar.earthlyBranch),1),a[7]||(a[7]=(0,i.Lk)("div",{class:"label"},"时柱",-1)),(0,i.Lk)("div",ze,(0,v.v_)(p.value.hourPillar.naYin),1),(0,i.Lk)("div",De,(0,v.v_)(p.value.hourPillar.shiShen),1),(0,i.Lk)("div",$e,(0,v.v_)(p.value.hourPillar.wangShuai),1)])])):((0,i.uX)(),(0,i.CE)("div",Te,[(0,i.bF)(o,{description:"八字数据加载失败，请重试"}),(0,i.bF)(d,{type:"primary",size:"small",onClick:E},{default:(0,i.k6)((()=>a[8]||(a[8]=[(0,i.eW)("重新加载")]))),_:1,__:[8]})])),a[19]||(a[19]=(0,i.Lk)("h3",null,"五行分布",-1)),p.value&&p.value.fiveElements?((0,i.uX)(),(0,i.CE)("div",We,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(p.value.fiveElements,((e,a)=>((0,i.uX)(),(0,i.CE)("div",{class:"element",key:a},[(0,i.Lk)("div",xe,(0,v.v_)(m(a)),1),(0,i.Lk)("div",Re,(0,v.v_)(e),1)])))),128))])):((0,i.uX)(),(0,i.CE)("div",Ke,[((0,i.uX)(),(0,i.CE)(i.FK,null,(0,i.pI)(["wood","fire","earth","metal","water"],(e=>(0,i.Lk)("div",{class:"element",key:e},[(0,i.Lk)("div",Ye,(0,v.v_)(m(e)),1),a[9]||(a[9]=(0,i.Lk)("div",{class:"element-value"},"--",-1))]))),64))])),a[20]||(a[20]=(0,i.Lk)("h3",null,"神煞信息",-1)),p.value&&p.value.shenSha?((0,i.uX)(),(0,i.CE)("div",je,[(0,i.Lk)("div",Oe,[(0,i.Lk)("div",qe,[a[10]||(a[10]=(0,i.Lk)("span",{class:"label"},"日冲",-1)),(0,i.Lk)("span",Ve,(0,v.v_)(p.value.shenSha.dayChong),1)]),(0,i.Lk)("div",Ue,[a[11]||(a[11]=(0,i.Lk)("span",{class:"label"},"值神",-1)),(0,i.Lk)("span",Be,(0,v.v_)(p.value.shenSha.zhiShen),1)]),(0,i.Lk)("div",Me,[a[12]||(a[12]=(0,i.Lk)("span",{class:"label"},"喜神",-1)),(0,i.Lk)("span",Qe,(0,v.v_)(p.value.shenSha.xiShen),1)]),(0,i.Lk)("div",Ne,[a[13]||(a[13]=(0,i.Lk)("span",{class:"label"},"福神",-1)),(0,i.Lk)("span",He,(0,v.v_)(p.value.shenSha.fuShen),1)]),(0,i.Lk)("div",Ge,[a[14]||(a[14]=(0,i.Lk)("span",{class:"label"},"财神",-1)),(0,i.Lk)("span",Ze,(0,v.v_)(p.value.shenSha.caiShen),1)])]),p.value.shenSha.benMing.length>0?((0,i.uX)(),(0,i.CE)("div",Je,[a[15]||(a[15]=(0,i.Lk)("h4",null,"本命神煞",-1)),(0,i.Lk)("div",ea,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(p.value.shenSha.benMing,((e,a)=>((0,i.uX)(),(0,i.CE)("span",{key:a,class:"ben-ming-item"},(0,v.v_)(e),1)))),128))])])):(0,i.Q3)("",!0)])):((0,i.uX)(),(0,i.CE)("div",aa,[(0,i.bF)(g,{inset:""},{default:(0,i.k6)((()=>[(0,i.bF)(y,{title:"神煞信息",value:"暂无数据"})])),_:1})])),a[21]||(a[21]=(0,i.Lk)("h3",null,"大运信息",-1)),p.value&&p.value.daYun?((0,i.uX)(),(0,i.CE)("div",la,[(0,i.Lk)("div",ta,[(0,i.Lk)("p",null,"起运年龄: "+(0,v.v_)(p.value.daYun.startAge)+"岁",1),(0,i.Lk)("p",null,"起运年份: "+(0,v.v_)(p.value.daYun.startYear)+"年",1),(0,i.Lk)("p",null,"大运顺序: "+(0,v.v_)(p.value.daYun.isForward?"顺行":"逆行"),1)]),(0,i.Lk)("div",na,[(0,i.Lk)("table",sa,[a[16]||(a[16]=(0,i.Lk)("thead",null,[(0,i.Lk)("tr",null,[(0,i.Lk)("th",null,"年龄"),(0,i.Lk)("th",null,"年份"),(0,i.Lk)("th",null,"天干"),(0,i.Lk)("th",null,"地支"),(0,i.Lk)("th",null,"纳音"),(0,i.Lk)("th",null,"吉凶")])],-1)),(0,i.Lk)("tbody",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(p.value.daYun.daYunList,((e,a)=>((0,i.uX)(),(0,i.CE)("tr",{key:a},[(0,i.Lk)("td",null,(0,v.v_)(e.startAge)+"-"+(0,v.v_)(e.endAge),1),(0,i.Lk)("td",null,(0,v.v_)(e.startYear)+"-"+(0,v.v_)(e.endYear),1),(0,i.Lk)("td",null,(0,v.v_)(e.heavenlyStem),1),(0,i.Lk)("td",null,(0,v.v_)(e.earthlyBranch),1),(0,i.Lk)("td",null,(0,v.v_)(e.naYin),1),(0,i.Lk)("td",null,(0,v.v_)(e.jiXiong),1)])))),128))])])])])):((0,i.uX)(),(0,i.CE)("div",ia,[(0,i.bF)(g,{inset:""},{default:(0,i.k6)((()=>[(0,i.bF)(y,{title:"大运信息",value:"暂无数据"})])),_:1})])),a[22]||(a[22]=(0,i.Lk)("h3",null,"流年信息",-1)),p.value&&p.value.flowingYears&&p.value.flowingYears.length?((0,i.uX)(),(0,i.CE)("div",oa,[(0,i.Lk)("table",ra,[a[17]||(a[17]=(0,i.Lk)("thead",null,[(0,i.Lk)("tr",null,[(0,i.Lk)("th",null,"年份"),(0,i.Lk)("th",null,"年龄"),(0,i.Lk)("th",null,"天干"),(0,i.Lk)("th",null,"地支"),(0,i.Lk)("th",null,"五行"),(0,i.Lk)("th",null,"神煞"),(0,i.Lk)("th",null,"吉凶")])],-1)),(0,i.Lk)("tbody",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(p.value.flowingYears,((e,a)=>((0,i.uX)(),(0,i.CE)("tr",{key:a},[(0,i.Lk)("td",null,(0,v.v_)(e.year),1),(0,i.Lk)("td",null,(0,v.v_)(e.age),1),(0,i.Lk)("td",null,(0,v.v_)(e.heavenlyStem),1),(0,i.Lk)("td",null,(0,v.v_)(e.earthlyBranch),1),(0,i.Lk)("td",null,(0,v.v_)(m(e.ganElement))+"/"+(0,v.v_)(m(e.zhiElement)),1),(0,i.Lk)("td",null,(0,v.v_)(e.shenSha&&Array.isArray(e.shenSha)?e.shenSha.join(", "):"无"),1),(0,i.Lk)("td",null,(0,v.v_)(e.jiXiong||"未知"),1)])))),128))])])])):((0,i.uX)(),(0,i.CE)("div",ua,[(0,i.bF)(o,{description:"流年数据暂无"})]))])])),_:1}),(0,i.bF)(b,{title:"AI分析结果"},{default:(0,i.k6)((()=>[(0,i.Lk)("div",ca,[null!==h.value&&h.value<0?((0,i.uX)(),(0,i.CE)("div",da,[(0,i.bF)(n,{color:"#1989fa",background:"#ecf9ff","left-icon":"info-o"},{default:(0,i.k6)((()=>a[23]||(a[23]=[(0,i.eW)(" 此分析针对未来出生的宝宝，重点关注性格特点、天赋才能和健康发展趋势。 ")]))),_:1,__:[23]})])):null!==h.value&&h.value<6?((0,i.uX)(),(0,i.CE)("div",va,[(0,i.bF)(n,{color:"#1989fa",background:"#ecf9ff","left-icon":"info-o"},{default:(0,i.k6)((()=>[(0,i.eW)(" 此分析针对婴幼儿("+(0,v.v_)(h.value)+"岁)，重点关注性格特点、天赋才能和健康发展趋势。 ",1)])),_:1})])):null!==h.value&&h.value<18?((0,i.uX)(),(0,i.CE)("div",ha,[(0,i.bF)(n,{color:"#1989fa",background:"#ecf9ff","left-icon":"info-o"},{default:(0,i.k6)((()=>[(0,i.eW)(" 此分析针对未成年人("+(0,v.v_)(h.value)+"岁)，重点关注性格特点、学业发展和健康状况。 ",1)])),_:1})])):(0,i.Q3)("",!0),u.value?((0,i.uX)(),(0,i.Wv)(n,{key:3,color:"#1989fa",background:"#ecf9ff","left-icon":"info-o",scrollable:!1,class:"analysis-progress-notice"},{default:(0,i.k6)((()=>[(0,i.Lk)("div",ya,[a[24]||(a[24]=(0,i.Lk)("p",null,"AI正在生成八字分析结果，这可能需要30-60秒",-1)),(0,i.bF)(t,{percentage:c.value,"show-pivot":!1,color:"#1989fa"},null,8,["percentage"])])])),_:1})):(0,i.Q3)("",!0),(0,i.Lk)("div",pa,[a[26]||(a[26]=(0,i.Lk)("h3",null,"八字命局核心分析",-1)),!k.value.coreAnalysis||"暂无"===k.value.coreAnalysis||k.value.coreAnalysis.includes("正在分析")?((0,i.uX)(),(0,i.CE)("div",ka,[(0,i.bF)(L,{size:"24px",vertical:""},{default:(0,i.k6)((()=>a[25]||(a[25]=[(0,i.eW)("分析生成中...")]))),_:1,__:[25]})])):((0,i.uX)(),(0,i.CE)("p",ga,(0,v.v_)(k.value.coreAnalysis),1))]),(0,i.Lk)("div",ma,[a[28]||(a[28]=(0,i.Lk)("h3",null,"五行旺衰与用神",-1)),!k.value.fiveElements||"暂无"===k.value.fiveElements||k.value.fiveElements.includes("正在分析")?((0,i.uX)(),(0,i.CE)("div",fa,[(0,i.bF)(L,{size:"24px",vertical:""},{default:(0,i.k6)((()=>a[27]||(a[27]=[(0,i.eW)("分析生成中...")]))),_:1,__:[27]})])):((0,i.uX)(),(0,i.CE)("p",ba,(0,v.v_)(k.value.fiveElements),1))]),(0,i.Lk)("div",_a,[a[30]||(a[30]=(0,i.Lk)("h3",null,"神煞解析",-1)),!k.value.shenShaAnalysis||"暂无"===k.value.shenShaAnalysis||k.value.shenShaAnalysis.includes("正在分析")?((0,i.uX)(),(0,i.CE)("div",La,[(0,i.bF)(L,{size:"24px",vertical:""},{default:(0,i.k6)((()=>a[29]||(a[29]=[(0,i.eW)("分析生成中...")]))),_:1,__:[29]})])):((0,i.uX)(),(0,i.CE)("p",wa,(0,v.v_)(k.value.shenShaAnalysis),1))]),(0,i.Lk)("div",Ca,[a[32]||(a[32]=(0,i.Lk)("h3",null,"大运与流年关键节点",-1)),!k.value.keyPoints||"暂无"===k.value.keyPoints||k.value.keyPoints.includes("正在分析")?((0,i.uX)(),(0,i.CE)("div",Fa,[(0,i.bF)(L,{size:"24px",vertical:""},{default:(0,i.k6)((()=>a[31]||(a[31]=[(0,i.eW)("分析生成中...")]))),_:1,__:[31]})])):((0,i.uX)(),(0,i.CE)("p",Pa,(0,v.v_)(k.value.keyPoints),1))]),(0,i.Lk)("div",Ea,[(0,i.Lk)("h3",null,(0,v.v_)(null!==h.value&&h.value>=18?"婚姻感情":"未来感情发展"),1),!k.value.relationship||"暂无"===k.value.relationship||k.value.relationship.includes("正在分析")?((0,i.uX)(),(0,i.CE)("div",Aa,[(0,i.bF)(L,{size:"24px",vertical:""},{default:(0,i.k6)((()=>a[33]||(a[33]=[(0,i.eW)("分析生成中...")]))),_:1,__:[33]})])):((0,i.uX)(),(0,i.CE)("div",Ia,[X.value.relationship||X.value.marriage?((0,i.uX)(),(0,i.CE)("div",Sa,[(0,i.Lk)("p",null,(0,v.v_)(X.value.relationship||X.value.marriage),1),(0,i.Lk)("div",Xa,[(0,i.bF)(F,{type:"primary",size:"medium"},{default:(0,i.k6)((()=>a[34]||(a[34]=[(0,i.eW)("深度分析")]))),_:1,__:[34]})])])):((0,i.uX)(),(0,i.CE)("p",za,(0,v.v_)(k.value.relationship),1))]))]),(0,i.Lk)("div",Da,[(0,i.Lk)("h3",null,(0,v.v_)(null!==h.value&&h.value>=18?"事业财运":"未来事业财运"),1),!k.value.career||"暂无"===k.value.career||k.value.career.includes("正在分析")?((0,i.uX)(),(0,i.CE)("div",$a,[(0,i.bF)(L,{size:"24px",vertical:""},{default:(0,i.k6)((()=>a[35]||(a[35]=[(0,i.eW)("分析生成中...")]))),_:1,__:[35]})])):((0,i.uX)(),(0,i.CE)("div",Ta,[X.value.career||X.value.work||X.value.money||X.value.wealth?((0,i.uX)(),(0,i.CE)("div",Wa,[(0,i.Lk)("p",null,(0,v.v_)(X.value.career||X.value.work||X.value.money||X.value.wealth),1),(0,i.Lk)("div",xa,[(0,i.bF)(F,{type:"primary",size:"medium"},{default:(0,i.k6)((()=>a[36]||(a[36]=[(0,i.eW)("深度分析")]))),_:1,__:[36]})])])):((0,i.uX)(),(0,i.CE)("p",Ra,(0,v.v_)(k.value.career),1))]))]),(0,i.Lk)("div",Ka,[(0,i.Lk)("h3",null,(0,v.v_)(null!==h.value&&h.value>=18?"子女情况":"未来子女缘分"),1),!k.value.children||"暂无"===k.value.children||k.value.children.includes("正在分析")?((0,i.uX)(),(0,i.CE)("div",Ya,[(0,i.bF)(L,{size:"24px",vertical:""},{default:(0,i.k6)((()=>a[37]||(a[37]=[(0,i.eW)("分析生成中...")]))),_:1,__:[37]})])):((0,i.uX)(),(0,i.CE)("div",ja,[X.value.children||X.value.family?((0,i.uX)(),(0,i.CE)("div",Oa,[(0,i.Lk)("p",null,(0,v.v_)(X.value.children||X.value.family),1),(0,i.Lk)("div",qa,[(0,i.bF)(F,{type:"primary",size:"medium"},{default:(0,i.k6)((()=>a[38]||(a[38]=[(0,i.eW)("深度分析")]))),_:1,__:[38]})])])):((0,i.uX)(),(0,i.CE)("p",Va,(0,v.v_)(k.value.children),1))]))]),(0,i.Lk)("div",Ua,[a[41]||(a[41]=(0,i.Lk)("h3",null,"父母情况",-1)),!k.value.parents||"暂无"===k.value.parents||k.value.parents.includes("正在分析")?((0,i.uX)(),(0,i.CE)("div",Ba,[(0,i.bF)(L,{size:"24px",vertical:""},{default:(0,i.k6)((()=>a[39]||(a[39]=[(0,i.eW)("分析生成中...")]))),_:1,__:[39]})])):((0,i.uX)(),(0,i.CE)("div",Ma,[X.value.parents?((0,i.uX)(),(0,i.CE)("div",Qa,[(0,i.Lk)("p",null,(0,v.v_)(X.value.parents),1),(0,i.Lk)("div",Na,[(0,i.bF)(F,{type:"primary",size:"medium"},{default:(0,i.k6)((()=>a[40]||(a[40]=[(0,i.eW)("深度分析")]))),_:1,__:[40]})])])):((0,i.uX)(),(0,i.CE)("p",Ha,(0,v.v_)(k.value.parents),1))]))]),(0,i.Lk)("div",Ga,[a[44]||(a[44]=(0,i.Lk)("h3",null,"身体健康",-1)),!k.value.health||"暂无"===k.value.health||k.value.health.includes("正在分析")?((0,i.uX)(),(0,i.CE)("div",Za,[(0,i.bF)(L,{size:"24px",vertical:""},{default:(0,i.k6)((()=>a[42]||(a[42]=[(0,i.eW)("分析生成中...")]))),_:1,__:[42]})])):((0,i.uX)(),(0,i.CE)("div",Ja,[X.value.health?((0,i.uX)(),(0,i.CE)("div",el,[(0,i.Lk)("p",null,(0,v.v_)(X.value.health),1),(0,i.Lk)("div",al,[(0,i.bF)(F,{type:"primary",size:"medium"},{default:(0,i.k6)((()=>a[43]||(a[43]=[(0,i.eW)("深度分析")]))),_:1,__:[43]})])])):((0,i.uX)(),(0,i.CE)("p",ll,(0,v.v_)(k.value.health),1))]))]),(0,i.Lk)("div",tl,[a[47]||(a[47]=(0,i.Lk)("h3",null,"学业",-1)),!k.value.education||"暂无"===k.value.education||k.value.education.includes("正在分析")?((0,i.uX)(),(0,i.CE)("div",nl,[(0,i.bF)(L,{size:"24px",vertical:""},{default:(0,i.k6)((()=>a[45]||(a[45]=[(0,i.eW)("分析生成中...")]))),_:1,__:[45]})])):((0,i.uX)(),(0,i.CE)("div",sl,[X.value.education||X.value.study?((0,i.uX)(),(0,i.CE)("div",il,[(0,i.Lk)("p",null,(0,v.v_)(X.value.education||X.value.study),1),(0,i.Lk)("div",ol,[(0,i.bF)(F,{type:"primary",size:"medium"},{default:(0,i.k6)((()=>a[46]||(a[46]=[(0,i.eW)("深度分析")]))),_:1,__:[46]})])])):((0,i.uX)(),(0,i.CE)("p",rl,(0,v.v_)(k.value.education),1))]))]),(0,i.Lk)("div",ul,[a[50]||(a[50]=(0,i.Lk)("h3",null,"人际关系",-1)),!k.value.social||"暂无"===k.value.social||k.value.social.includes("正在分析")?((0,i.uX)(),(0,i.CE)("div",cl,[(0,i.bF)(L,{size:"24px",vertical:""},{default:(0,i.k6)((()=>a[48]||(a[48]=[(0,i.eW)("分析生成中...")]))),_:1,__:[48]})])):((0,i.uX)(),(0,i.CE)("div",dl,[X.value.social||X.value.relationship||X.value.friends?((0,i.uX)(),(0,i.CE)("div",vl,[(0,i.Lk)("p",null,(0,v.v_)(X.value.social||X.value.relationship||X.value.friends),1),(0,i.Lk)("div",hl,[(0,i.bF)(F,{type:"primary",size:"medium"},{default:(0,i.k6)((()=>a[49]||(a[49]=[(0,i.eW)("深度分析")]))),_:1,__:[49]})])])):((0,i.uX)(),(0,i.CE)("p",yl,(0,v.v_)(k.value.social),1))]))]),(0,i.Lk)("div",pl,[a[53]||(a[53]=(0,i.Lk)("h3",null,"近五年运势",-1)),!k.value.future||"暂无"===k.value.future||k.value.future.includes("正在分析")?((0,i.uX)(),(0,i.CE)("div",kl,[(0,i.bF)(L,{size:"24px",vertical:""},{default:(0,i.k6)((()=>a[51]||(a[51]=[(0,i.eW)("分析生成中...")]))),_:1,__:[51]})])):((0,i.uX)(),(0,i.CE)("div",gl,[X.value.future||X.value.fiveYears?((0,i.uX)(),(0,i.CE)("div",ml,[(0,i.Lk)("p",null,(0,v.v_)(X.value.future||X.value.fiveYears),1),(0,i.Lk)("div",fl,[(0,i.bF)(F,{type:"primary",size:"medium"},{default:(0,i.k6)((()=>a[52]||(a[52]=[(0,i.eW)("深度分析")]))),_:1,__:[52]})])])):((0,i.uX)(),(0,i.CE)("p",bl,(0,v.v_)(k.value.future),1))]))])])])),_:1})])),_:1},8,["modelValue"]),(0,i.Lk)("div",_l,[(0,i.bF)(d,{type:"primary",block:"",onClick:_},{default:(0,i.k6)((()=>a[54]||(a[54]=[(0,i.eW)(" 下载PDF报告 ")]))),_:1,__:[54]}),(0,i.bF)(d,{plain:"",type:"primary",block:"",style:{"margin-top":"10px"},onClick:w},{default:(0,i.k6)((()=>a[55]||(a[55]=[(0,i.eW)(" 分享结果 ")]))),_:1,__:[55]}),(0,i.bF)(d,{plain:"",type:"info",block:"",style:{"margin-top":"10px"},onClick:C},{default:(0,i.k6)((()=>a[56]||(a[56]=[(0,i.eW)(" 本地生成PDF ")]))),_:1,__:[56]}),(0,i.bF)(d,{plain:"",type:"warning",block:"",style:{"margin-top":"10px"},onClick:E},{default:(0,i.k6)((()=>a[57]||(a[57]=[(0,i.eW)(" 重新加载分析数据 ")]))),_:1,__:[57]})]),p.value&&!r.value?((0,i.uX)(),(0,i.CE)("div",Ll,[a[60]||(a[60]=(0,i.Lk)("h2",{class:"section-title"},"深度分析",-1)),a[61]||(a[61]=(0,i.Lk)("p",{class:"section-desc"},"选择您感兴趣的领域，进行深度分析",-1)),(0,i.Lk)("div",wl,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(A.value,(e=>((0,i.uX)(),(0,i.CE)("div",{key:e.id,class:(0,v.C4)(["followup-option",{paid:e.paid}]),onClick:a=>D(e)},[(0,i.Lk)("div",Fl,[(0,i.Lk)("span",Pl,(0,v.v_)(e.name),1),e.paid?((0,i.uX)(),(0,i.CE)("span",El,"已解锁")):((0,i.uX)(),(0,i.CE)("span",Al,"￥9.9"))])],10,Cl)))),128))]),I.value&&I.value.paid?((0,i.uX)(),(0,i.CE)("div",Il,[(0,i.Lk)("h3",null,(0,v.v_)(I.value.name)+"分析",1),z.value?((0,i.uX)(),(0,i.CE)("div",Sl,[(0,i.bF)(L,{size:"24px",vertical:""},{default:(0,i.k6)((()=>a[58]||(a[58]=[(0,i.eW)("分析加载中...")]))),_:1,__:[58]})])):X.value[I.value.id]?((0,i.uX)(),(0,i.CE)("div",zl,(0,v.v_)(X.value[I.value.id]),1)):((0,i.uX)(),(0,i.CE)("div",Xl,[(0,i.bF)(o,{description:"分析结果尚未生成，请稍后刷新页面"}),(0,i.bF)(d,{type:"primary",size:"small",onClick:a[1]||(a[1]=e=>K(I.value.id))},{default:(0,i.k6)((()=>a[59]||(a[59]=[(0,i.eW)(" 刷新分析 ")]))),_:1,__:[59]})]))])):(0,i.Q3)("",!0)])):(0,i.Q3)("",!0),(0,i.bF)(T,{show:S.value,"onUpdate:show":a[2]||(a[2]=e=>S.value=e),title:"深度分析","confirm-button-text":"支付 ￥9.9",onConfirm:$,"before-close":()=>!z.value},{default:(0,i.k6)((()=>[(0,i.Lk)("div",Dl,[(0,i.Lk)("p",null,"您选择了「"+(0,v.v_)(I.value?.name)+"」深度分析",1),a[62]||(a[62]=(0,i.Lk)("p",null,"支付后，AI将根据您的八字和流年运势，为您提供专业的命理分析",-1))])])),_:1},8,["show","before-close"])])}}},Tl=(0,S.A)($l,[["__scopeId","data-v-6f51eb3a"]]),Wl=Tl,xl=[{path:"/",component:_,meta:{title:"八字命理AI人生指导"}},{path:"/login",component:z,meta:{title:"用户登录"}},{path:"/user",component:O,meta:{title:"个人中心"}},{path:"/payment",component:le,meta:{title:"订单支付"}},{path:"/result/:id",component:Wl,meta:{title:"分析结果"}}],Rl=xl;var Kl=l(7654);l(2241);const Yl=(0,n.aE)({history:(0,n.LA)(),routes:Rl}),jl=(0,s.Ey)(),Ol=(0,t.Ef)(d);Ol.use(Kl.Ay),Ol.use(Yl),Ol.use(jl),Ol.mount("#app")}},a={};function l(t){var n=a[t];if(void 0!==n)return n.exports;var s=a[t]={exports:{}};return e[t].call(s.exports,s,s.exports,l),s.exports}l.m=e,(()=>{var e=[];l.O=(a,t,n,s)=>{if(!t){var i=1/0;for(c=0;c<e.length;c++){for(var[t,n,s]=e[c],o=!0,r=0;r<t.length;r++)(!1&s||i>=s)&&Object.keys(l.O).every((e=>l.O[e](t[r])))?t.splice(r--,1):(o=!1,s<i&&(i=s));if(o){e.splice(c--,1);var u=n();void 0!==u&&(a=u)}}return a}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[t,n,s]}})(),(()=>{l.n=e=>{var a=e&&e.__esModule?()=>e["default"]:()=>e;return l.d(a,{a}),a}})(),(()=>{var e,a=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;l.t=function(t,n){if(1&n&&(t=this(t)),8&n)return t;if("object"===typeof t&&t){if(4&n&&t.__esModule)return t;if(16&n&&"function"===typeof t.then)return t}var s=Object.create(null);l.r(s);var i={};e=e||[null,a({}),a([]),a(a)];for(var o=2&n&&t;"object"==typeof o&&!~e.indexOf(o);o=a(o))Object.getOwnPropertyNames(o).forEach((e=>i[e]=()=>t[e]));return i["default"]=()=>t,l.d(s,i),s}})(),(()=>{l.d=(e,a)=>{for(var t in a)l.o(a,t)&&!l.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})}})(),(()=>{l.f={},l.e=e=>Promise.all(Object.keys(l.f).reduce(((a,t)=>(l.f[t](e,a),a)),[]))})(),(()=>{l.u=e=>"js/"+e+"."+{353:"735a904a",967:"84b71931"}[e]+".js"})(),(()=>{l.miniCssF=e=>{}})(),(()=>{l.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{l.o=(e,a)=>Object.prototype.hasOwnProperty.call(e,a)})(),(()=>{var e={},a="bazi-frontend:";l.l=(t,n,s,i)=>{if(e[t])e[t].push(n);else{var o,r;if(void 0!==s)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var d=u[c];if(d.getAttribute("src")==t||d.getAttribute("data-webpack")==a+s){o=d;break}}o||(r=!0,o=document.createElement("script"),o.charset="utf-8",o.timeout=120,l.nc&&o.setAttribute("nonce",l.nc),o.setAttribute("data-webpack",a+s),o.src=t),e[t]=[n];var v=(a,l)=>{o.onerror=o.onload=null,clearTimeout(h);var n=e[t];if(delete e[t],o.parentNode&&o.parentNode.removeChild(o),n&&n.forEach((e=>e(l))),a)return a(l)},h=setTimeout(v.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=v.bind(null,o.onerror),o.onload=v.bind(null,o.onload),r&&document.head.appendChild(o)}}})(),(()=>{l.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{l.p="/"})(),(()=>{var e={524:0};l.f.j=(a,t)=>{var n=l.o(e,a)?e[a]:void 0;if(0!==n)if(n)t.push(n[2]);else{var s=new Promise(((l,t)=>n=e[a]=[l,t]));t.push(n[2]=s);var i=l.p+l.u(a),o=new Error,r=t=>{if(l.o(e,a)&&(n=e[a],0!==n&&(e[a]=void 0),n)){var s=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;o.message="Loading chunk "+a+" failed.\n("+s+": "+i+")",o.name="ChunkLoadError",o.type=s,o.request=i,n[1](o)}};l.l(i,r,"chunk-"+a,a)}},l.O.j=a=>0===e[a];var a=(a,t)=>{var n,s,[i,o,r]=t,u=0;if(i.some((a=>0!==e[a]))){for(n in o)l.o(o,n)&&(l.m[n]=o[n]);if(r)var c=r(l)}for(a&&a(t);u<i.length;u++)s=i[u],l.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return l.O(c)},t=self["webpackChunkbazi_frontend"]=self["webpackChunkbazi_frontend"]||[];t.forEach(a.bind(null,0)),t.push=a.bind(null,t.push.bind(t))})();var t=l.O(void 0,[504],(()=>l(6709)));t=l.O(t)})();
//# sourceMappingURL=app.eeca56a4.js.map